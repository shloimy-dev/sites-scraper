<!DOCTYPE html><html lang="en" class="wf-myriadpro-n7-active wf-myriadpro-i7-active wf-myriadpro-i4-active wf-myriadpro-n4-active wf-ubuntu-n4-active wf-ubuntu-n7-active wf-active"><head>

	<meta charset="UTF-8">
	
	<base href="https://winning-moves.com/">
	<style type="text/css">
	#qm0 li.secure, #qm0 a.secure { display: NONE; }
	</style>
	
	
	<title>Winning Moves Games: Crazy Canoeâ„¢</title>
	<!-- 96QUYq7l94pmuw6p-6Vl6SZ5wng -->
	<meta name="description" content="You're packing for your family camping trip and need to fit all your gear into your canoe.

It's a delicate balancing act to keep the Crazy Canoe afloat. Steady your hand carefully slot a piece onto the ever growing stack. Lookout! You don't want anything to drop into the river! Any pieces that fall off during a turn go back to the palyer who caused a spill. Once a player has successfully stacked all their gear into the Crazy Canoe, they need to get Finn, the family dog, balanced safely on top for the win!">
	<meta name="keywords" content="Jenga, Balancing Game, Canoe, Fishing Games, Parker Brothers, Winning Moves, Hasbro, Milton Bradley">
	<style type="text/css">.ui-widget-content { background:none !important; }</style>
	<link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.8.13/themes/base/jquery-ui.css">
	<link rel="stylesheet" type="text/css" href="css/layout.css">
	<link rel="stylesheet" type="text/css" href="css/products.css">
	
	
	<script type="text/javascript" async="" src="https://ssl.google-analytics.com/ga.js"></script><script src="https://connect.facebook.net/en_US/sdk.js?hash=b13307b66cdb19f09e91e6782bbd2895" async="" crossorigin="anonymous"></script><script id="facebook-jssdk" src="//connect.facebook.net/en_US/sdk.js#xfbml=1&amp;version=v2.4&amp;appId=213575610533"></script><script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
	<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jqueryui/1.8.13/jquery-ui.min.js"></script>
	<script type="text/javascript" src="js/nav.js"></script><style type="text/css">.qmfv{visibility:visible !important;}.qmfh{visibility:hidden !important;}</style><style type="text/css">.qmvibcssmenu{}#qm0 .qm-ibcss-static span{background-color:#aaaaaa;border-color:#ffffff;}div#qm0  .qm-ibcss-hover span{background-color:#000000;border-color:#ffffff;}body div#qm0  .qm-ibcss-active span{background-color:#000000;border-color:#ffffff;}#qm0 div .qm-ibcss-static span{background-color:transparent;border-color:#444444;}div#qm0  div .qm-ibcss-hover span{background-color:transparent;border-color:#dd3300;}body div#qm0  div .qm-ibcss-active span{background-color:transparent;border-color:#dd3300;}</style>
	<script type="text/javascript" src="js/scripts.js"></script>
	<script type="text/javascript" src="//use.typekit.net/nnd7xtu.js"></script>
	<style type="text/css">.tk-myriad-pro{font-family:"myriad-pro",sans-serif;}.tk-ubuntu{font-family:"ubuntu",sans-serif;}</style><style type="text/css">@font-face{font-family:myriad-pro;src:url(https://use.typekit.net/af/1b1b1e/00000000000000000001709e/27/l?subset_id=2&fvd=n7&v=3) format("woff2"),url(https://use.typekit.net/af/1b1b1e/00000000000000000001709e/27/d?subset_id=2&fvd=n7&v=3) format("woff"),url(https://use.typekit.net/af/1b1b1e/00000000000000000001709e/27/a?subset_id=2&fvd=n7&v=3) format("opentype");font-weight:700;font-style:normal;font-stretch:normal;font-display:auto;}@font-face{font-family:myriad-pro;src:url(https://use.typekit.net/af/2e2357/00000000000000000001709f/27/l?subset_id=2&fvd=i7&v=3) format("woff2"),url(https://use.typekit.net/af/2e2357/00000000000000000001709f/27/d?subset_id=2&fvd=i7&v=3) format("woff"),url(https://use.typekit.net/af/2e2357/00000000000000000001709f/27/a?subset_id=2&fvd=i7&v=3) format("opentype");font-weight:700;font-style:italic;font-stretch:normal;font-display:auto;}@font-face{font-family:myriad-pro;src:url(https://use.typekit.net/af/d32e26/00000000000000000001709b/27/l?subset_id=2&fvd=i4&v=3) format("woff2"),url(https://use.typekit.net/af/d32e26/00000000000000000001709b/27/d?subset_id=2&fvd=i4&v=3) format("woff"),url(https://use.typekit.net/af/d32e26/00000000000000000001709b/27/a?subset_id=2&fvd=i4&v=3) format("opentype");font-weight:400;font-style:italic;font-stretch:normal;font-display:auto;}@font-face{font-family:myriad-pro;src:url(https://use.typekit.net/af/cafa63/00000000000000000001709a/27/l?subset_id=2&fvd=n4&v=3) format("woff2"),url(https://use.typekit.net/af/cafa63/00000000000000000001709a/27/d?subset_id=2&fvd=n4&v=3) format("woff"),url(https://use.typekit.net/af/cafa63/00000000000000000001709a/27/a?subset_id=2&fvd=n4&v=3) format("opentype");font-weight:400;font-style:normal;font-stretch:normal;font-display:auto;}@font-face{font-family:ubuntu;src:url(https://use.typekit.net/af/4db7db/0000000000000000000123f0/27/l?subset_id=2&fvd=n4&v=3) format("woff2"),url(https://use.typekit.net/af/4db7db/0000000000000000000123f0/27/d?subset_id=2&fvd=n4&v=3) format("woff"),url(https://use.typekit.net/af/4db7db/0000000000000000000123f0/27/a?subset_id=2&fvd=n4&v=3) format("opentype");font-weight:400;font-style:normal;font-stretch:normal;font-display:auto;}@font-face{font-family:ubuntu;src:url(https://use.typekit.net/af/df828c/0000000000000000000123e9/27/l?subset_id=2&fvd=n7&v=3) format("woff2"),url(https://use.typekit.net/af/df828c/0000000000000000000123e9/27/d?subset_id=2&fvd=n7&v=3) format("woff"),url(https://use.typekit.net/af/df828c/0000000000000000000123e9/27/a?subset_id=2&fvd=n7&v=3) format("opentype");font-weight:700;font-style:normal;font-stretch:normal;font-display:auto;}</style><script type="text/javascript">try{Typekit.load();}catch(e){}</script>

	<script src="//maps.googleapis.com/maps/api/js?sensor=false&amp;key=AIzaSyBIicy6LYVf4RTpo601wKh4-6pqSquorcs"></script>
	
	<script type="text/javascript" src="common_images/scripts/cycle.js"></script><meta property="og:image" content="https://winning-moves.com/images/1264_CrazyCanoeLrg.jpg"> 
	<style>
	/*#instagram-block{
		padding: 10px 10px 0px 10px;
		background-color: #e6e6e6;
		border: 1px solid #dadada;
		border-bottom: 0px;
		-webkit-border-radius: 5px;
		-webkit-border-radius: 5px;
		-moz-border-radius: 5px;
		-moz-border-radius: 5px;
		border-radius: 5px;
		display: inline-block;

	}
*/	#instagram-block h1{
		background: #45484d;
		background: -moz-linear-gradient(top, #45484d 0%, #000000 100%);
		background: -webkit-linear-gradient(top, #45484d 0%,#000000 100%);
		background: linear-gradient(to bottom, #45484d 0%,#000000 100%);
		filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#45484d', endColorstr='#000000',GradientType=0 );
		color: #fff;
		border-radius: 5px;
		padding: 8px 5px;
		margin-bottom: 10px;
		line-height: inherit;
	}
	</style>
<style type="text/css" data-fbcssmodules="css:fb.css.base css:fb.css.dialog css:fb.css.iframewidget">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0px;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:lucida grande,tahoma,verdana,arial,sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:400;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}@keyframes fb_transform{0%{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}

.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0px;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:lucida grande,tahoma,verdana,arial,sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:400;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}@keyframes fb_transform{0%{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}

.fb_dialog{background:#525252b3;position:absolute;top:-10000px;z-index:10001}.fb_dialog_advanced{border-radius:8px;padding:10px}.fb_dialog_content{background:#fff;color:#373737}.fb_dialog_close_icon{background:url(https://connect.facebook.net/rsrc.php/v4/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{left:5px;right:auto;top:5px}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://connect.facebook.net/rsrc.php/v4/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent}.fb_dialog_close_icon:active{background:url(https://connect.facebook.net/rsrc.php/v4/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:700;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://connect.facebook.net/rsrc.php/v4/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{height:100%;left:0;margin:0;overflow:visible;position:absolute;top:-10000px;transform:none;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://connect.facebook.net/rsrc.php/v4/ya/r/3rhSv5V8j3o.gif) #fff no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{background:none;height:auto;min-height:initial;min-width:initial;width:auto}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{clear:both;color:#fff;display:block;font-size:18px;padding-top:20px}#fb-root #fb_dialog_ipad_overlay{background:#0006;inset:0;min-height:100%;position:absolute;width:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_mobile .fb_dialog_iframe{position:sticky;top:0}.fb_dialog_content .dialog_header{background:linear-gradient(from(#738aba),to(#2c4987));border-bottom:1px solid;border-color:#043b87;box-shadow:#fff 0 1px 1px -1px inset;color:#fff;font:700 14px Helvetica,sans-serif;text-overflow:ellipsis;text-shadow:rgba(0,30,84,.296875) 0px -1px 0px;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:linear-gradient(from(#4267B2),to(#2a4887));background-clip:padding-box;border:1px solid #29487d;border-radius:3px;display:inline-block;line-height:18px;margin-top:3px;max-width:85px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{background:none;border:none;color:#fff;font:700 12px Helvetica,sans-serif;margin:2px -12px;padding:2px 6px 3px;text-shadow:rgba(0,30,84,.296875) 0px -1px 0px}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:700;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://connect.facebook.net/rsrc.php/v4/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #4A4A4A;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f5f6f7;border:1px solid #4A4A4A;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://connect.facebook.net/rsrc.php/v4/y2/r/onuUJj0tCqE.png);background-position:50% 50%;background-repeat:no-repeat;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0)}to{transform:rotate(360deg)}}

.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}
</style></head>

<body class="interior loggedout"><div id="WzTtDiV" style="visibility: hidden; position: absolute; overflow: hidden; padding: 0px; width: 1279px; left: -1280px; top: 0px;"></div>

	
		<div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; width: 0px; height: 0px;"><div></div></div></div>
		<script>(function(d, s, id) {
		var js, fjs = d.getElementsByTagName(s)[0];
		if (d.getElementById(id)) return;
		js = d.createElement(s); js.id = id;
		js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.4&appId=213575610533";
		fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));</script>

		<div id="container">

			<div id="header">

				<div id="social">
	<a href="http://www.facebook.com/WinningMovesGames" target="_blank"><img src="https://winning-moves.com/templates/gfx/facebook.png"></a>
	<a href="http://twitter.com/winningmovesusa" target="_blank"><img src="https://winning-moves.com/templates/gfx/twitter.png"></a>
	<a href="http://www.youtube.com/WinningMovesUSA" target="_blank"><img src="https://winning-moves.com/templates/gfx/youtube.png"></a>
	<a href="https://www.instagram.com/winningmovesusa/" target="_blank" id="insta-icon"><img src="https://winning-moves.com/templates/gfx/instagram.png"></a>
</div>
<ul id="util_nav" class="qmmc">
	<li><a href="default.asp" class="sprite-utility utility2">Home</a></li>
	<li><a href="showcart.asp" class="sprite-utility utility3">Shopping Cart</a></li>
	<li><a href="https://winning-moves.com/security_logon.asp?autopage=%2Fpc%5Fproduct%5Fdetail%2Easp%3Frewrite%3Dtrue%26key%3D79CA3421E53B4167AABDE2C1136CA5DA">Log In</a></li>
	<li class="qmclear">&nbsp;</li>
</ul>

				<a href="https://winning-moves.com"><img src="images/winning-moves-logo.png" id="logo"></a>

				
<ul id="qm0" class="qmmc">
	<li><a href="https://winning-moves.com/games/BestSellers.asp">Best Sellers</a></li>
	<li><span class="qmdivider"></span></li>
	<li><a href="https://winning-moves.com/games/CardGames.asp">Card</a></li>
	<li><span class="qmdivider"></span></li>
	<li><a href="https://winning-moves.com/games/ChildrensGames.asp">Children</a></li>
	<li><span class="qmdivider"></span></li>
	<li><a href="https://winning-moves.com/games/FamilyGames.asp">Family</a></li>
	<li><span class="qmdivider"></span></li>
	<li><a href="https://winning-moves.com/games/New2026.asp">New 2026!</a></li>
	<li><span class="qmdivider"></span></li>
	<li><a href="/product/passthepigsbrand.asp">Pass The Pigs</a></li>
	<li><span class="qmdivider"></span></li>
	<li><a href="https://winning-moves.com//product/twistables.asp">Twistables</a></li>
	<li class="qmclear">&nbsp;</li>
</ul>

			</div><!-- End Header -->

				<div id="content">
					<div id="content_header">
						
<ul id="qm1" class="qmmc">
	<li><span class="qmdivider"></span></li>
	<li><a href="https://winning-moves.com/games/Specials.asp">Specials</a></li>
	<li><span class="qmdivider"></span></li>
	<li class="mobile-site-link"><a href="mobile.asp">Mobile Website</a></li>
	<li class="mobile-site-link"><span class="qmdivider qmdividery"></span></li>
	<li class="qmclear">&nbsp;</li>
</ul>
<style>
	.validinput { border: 1px solid #008000; background-color: #CCFFCC; }
	.invalidinput { border: 1px solid #800000; background-color: #FFCCCC; color: #000; }
	
</style>

<div id="pc-searchwindow1" class="pc-searchwindow">
<form id="pc-searchform" name="pc-searchform" method="POST" action="" onsubmit="SubmitSearchForm1();return false;">

	<div class="pc-searchsection" id="pc-filter4">
		<div class="pc-searchheader">Enter Keyword(s)</div>
		<div class="pc-searchwin" id="filter_4_results">
			<input type="text" name="search_keyword" id="search_keyword" class="pc-searchinput" maxlength="255" onblur="if(this.value==''){this.value='Search'}" onfocus="if(this.value=='Search'){this.value=''}" value="Search">
			
			<div class="pc-searchindiv">
			<br><span class="pc-searchintext">in&nbsp;</span>
			<select name="search_string" id="search_string" class="pc-searchindrop" onchange="SetResultsPage1();">
				<option value="search_style=(searchlike~pcs.nm~&lt;Keyword&gt;|Or|searchlike~pcs.ds~&lt;Keyword&gt;|Or|searchlike~pcs.num~&lt;Keyword&gt;)&amp;search_prod=(searchlike~p.nm~&lt;Keyword&gt;|Or|searchlike~p.ds~&lt;Keyword&gt;|Or|searchlike~p.sku~&lt;Keyword&gt;);https://winning-moves.com/pc_combined_results.asp?tab=style" title="All Fields">All Fields</option><option value="search_style=(searchlike~pcs.nm~&lt;Keyword&gt;)&amp;search_prod=(searchlike~p.nm~&lt;Keyword&gt;);https://winning-moves.com/pc_combined_results.asp?tab=style" title="Name">Name</option><option value="search_style=(searchlike~pcs.ds~&lt;Keyword&gt;)&amp;search_prod=(searchlike~p.ds~&lt;Keyword&gt;);https://winning-moves.com/pc_combined_results.asp?tab=style" title="Description">Description</option><option value="search_prod=(searchlike~p.sku~&lt;Keyword&gt;);https://winning-moves.com/pc_combined_results.asp?tab=product" title="Part # (Contains)">Part # (Contains)</option><option value="search_prod=(searchleft~p.sku~&lt;Length&gt;~&lt;Keyword&gt;);https://winning-moves.com/pc_combined_results.asp?tab=product" title="Part # (Starts With)">Part # (Starts With)</option>
			</select>
			</div>
			
		</div>
	</div>
	
	<div class="pc-searchsection" id="pc-searchsubmit">
		
			<input type="Submit" name="search_submit" id="search_submit" value="" class="pc-submitbutton">
		
		<input type="hidden" id="valid_input" value="0">
		<input type="hidden" id="valid_key" value="">
	</div>
</form>
</div>
<script language="Javascript" type="text/javascript">
	var xmlHttp;
	var xmlDoc;

	var bOldCats = false;

	if ('0'=='1'){
		bOldCats = true;
	}

	function fncCheckValidInput1(){
		MakeSearchAJAXRequest(drawCheckResult1, '/pc_product_detail.asp?searchformaction=checkvalid&search_keyword=' + escape(document.getElementById('search_keyword').value), true, [], [], "Unable to check for valid input.", xmlDoc, null, true);
		DisableSearchForm1()
	}

	function drawCheckResult1(xmlDoc, vNull){
		try{
			if (getSearchNodeValue(xmlDoc, 'KeyField', 0).length==32){
				document.getElementById('search_keyword').className = 'pc-searchinput validinput';
				document.getElementById('valid_input').value = '1';
				document.getElementById('valid_key').value = getSearchNodeValue(xmlDoc, 'KeyField', 0);
				SubmitSearchForm1();
			} else {
				document.getElementById('search_keyword').className = 'pc-searchinput invalidinput';
				document.getElementById('search_keyword').value = 'Invalid Style Number!';
				document.getElementById('valid_input').value = '0';
				document.getElementById('valid_key').value = '';
			}
		}
		catch (err){
			document.getElementById('search_keyword').className = 'pc-searchinput invalidinput';
			document.getElementById('search_keyword').value = 'Invalid Style Number!';
			document.getElementById('valid_input').value = '0';
			document.getElementById('valid_key').value = '';
			//alert(err.message);
		}

		EnableSearchForm1();
	}

	function GetSubCategories1(vField){
		var strSearchVals = '';
		var strLoadingTxt = 'Loading...';
		
		if (bOldCats==true){
			switch (vField){
				case 2:
					strSearchVals = escape(document.getElementById('searchfield1').value);
					document.getElementById('filter_1_2').innerHTML = strLoadingTxt;
					document.getElementById('filter_1_2').style.display = 'block';
					document.getElementById('filter_1_3').innerHTML = '';
					document.getElementById('filter_1_3').style.display = 'none';
					document.getElementById('filter_1_4').innerHTML = '';
					document.getElementById('filter_1_4').style.display = 'none';
					break;
				case 3:
					strSearchVals = escape(document.getElementById('searchfield2').value);
					document.getElementById('filter_1_3').innerHTML = strLoadingTxt
					document.getElementById('filter_1_3').style.display = 'block';
					document.getElementById('filter_1_4').innerHTML = '';
					document.getElementById('filter_1_4').style.display = 'none';
					break;
				case 4:
					strSearchVals = escape(document.getElementById('searchfield3').value);
					document.getElementById('filter_1_4').innerHTML = strLoadingTxt;
					document.getElementById('filter_1_4').style.display = 'block';
					break;
			}

			if (document.getElementById('searchfield1').value.replace(/\s+/, "")!=''){				
				DisableSearchForm1();
				MakeSearchAJAXRequest(DrawSubCategories1, '/pc_product_detail.asp?searchformaction=ajaxcall&searchformactiontype=getoldcats&pc_key=' + strSearchVals + '&field=' + escape(vField), true, [], [], false, "", xmlDoc, vField, true);
			} else {
				document.getElementById('filter_1_2').innerHTML = '';
				document.getElementById('filter_1_2').style.display = 'none';
				document.getElementById('filter_1_3').innerHTML = '';
				document.getElementById('filter_1_3').style.display = 'none';
				document.getElementById('filter_1_4').innerHTML = '';
				document.getElementById('filter_1_4').style.display = 'none';
			}

		} else {
			switch (vField){
				case 2:
					strSearchVals = '&searchfield1=' + escape(document.getElementById('searchfield1').value) + '&searchfield2=' + escape(trim(getSearchQueryVariable('searchfield2')));
					document.getElementById('filter_1_2').innerHTML = strLoadingTxt;
					document.getElementById('filter_1_2').style.display = 'block';
					document.getElementById('filter_1_3').innerHTML = '';
					document.getElementById('filter_1_3').style.display = 'none';
					document.getElementById('filter_1_4').innerHTML = '';
					document.getElementById('filter_1_4').style.display = 'none';
					try{
						document.getElementById('filter_2_1').innerHTML = strLoadingTxt;
						document.getElementById('filter_2_1').style.display = 'block';
					}catch (err){
						//alert(err.message);
					}
					break;
				case 3:
					strSearchVals = '&searchfield1=' + escape(document.getElementById('searchfield1').value) + '&searchfield2=' + escape(document.getElementById('searchfield2').value) + '&searchfield3=' + escape(trim(getSearchQueryVariable('searchfield3')));
					document.getElementById('filter_1_3').innerHTML = strLoadingTxt;
					document.getElementById('filter_1_3').style.display = 'block';
					document.getElementById('filter_1_4').innerHTML = '';
					document.getElementById('filter_1_4').style.display = 'none';
					try{
						document.getElementById('filter_2_1').innerHTML = strLoadingTxt;
						document.getElementById('filter_2_1').style.display = 'block';
					} catch (err){
						//alert(err.message);
					}
					break;
				case 4:
					strSearchVals = '&searchfield1=' + escape(document.getElementById('searchfield1').value) + '&searchfield2=' + escape(document.getElementById('searchfield2').value) + '&searchfield3=' + escape(document.getElementById('searchfield3').value) + '&searchfield4=' + escape(trim(getSearchQueryVariable('searchfield4')));
					document.getElementById('filter_1_4').innerHTML = strLoadingTxt;
					document.getElementById('filter_1_4').style.display = 'block';
					try{
						document.getElementById('filter_2_1').innerHTML = strLoadingTxt;
						document.getElementById('filter_2_1').style.display = 'block';
					} catch (err){
						//alert(err.message);
					}
					break;
			}

			//Removed '' check to resolve bug - dand 2/1/2010
			//if (document.getElementById('searchfield1').value.replace(/\s+/, "")!=''){ 
				DisableSearchForm1();
				MakeSearchAJAXRequest(DrawSubCategories1, '/pc_product_detail.asp?searchformaction=ajaxcall&searchformactiontype=getsubcats&usestyle=0&field=' + escape(vField) + strSearchVals, true, [], [], false, "", xmlDoc, vField, true);
			/*} else { 
				document.getElementById('filter_1_2').innerHTML = '';
				document.getElementById('filter_1_2').style.display = 'none';
				document.getElementById('filter_1_3').innerHTML = '';
				document.getElementById('filter_1_3').style.display = 'none';
				document.getElementById('filter_1_4').innerHTML = '';
				document.getElementById('filter_1_4').style.display = 'none';
			}*/
		}
	}

	function DrawSubCategories1(xmlDoc, Step){
		var bContinue = false;
		var bFireNext = false;
		var bSelectedOpt = false;

		var sDisplay = '';
		var sStepPrePop = trim(getSearchQueryVariable('searchfield' + Step)).replace(new RegExp('%2520', 'g'), ' ');
		var sPrepop = sStepPrePop.replace(new RegExp('%20', 'g'), ' ');
		var sSel112 = '[Select Sub-Category]';
		var sSel113 = '[Select Sub-Category]';
		var sSel114 = '[Select Sub-Category]';
		var sSelOne = '[Select One]';
		var sValue = '';

		if ( Step <= parseInt('4') ){
			bContinue = true;
		}

		switch (Step){
			case 2:
				sSelOne = sSel112;
				break;
			case 3:
				sSelOne = sSel113;
				break;
			case 4:
				sSelOne = sSel114;
				break;
			default:
				sSelOne = '[Select One]';
				break;
		}

		if ((xmlDoc.childNodes.length > 0) && (bContinue==true)){
			try{
				if (bOldCats==true){
					oSubCats = xmlDoc.getElementsByTagName('record');
				} else {
					oSubCats = xmlDoc.getElementsByTagName('searchfield' + Step);
				}

				var sSelectOneText = sSelOne.replace(/<count>/ig, oSubCats.length);

				if (oSubCats.length > 0){
					document.getElementById('filter_1_' + Step).innerHTML = '<select name="searchfield' + Step + '" id="searchfield' + Step + '" class="pc-searchdrop" onchange="GetSubCategories1(' + (Step + 1) + ');"><option value="">' + sSelectOneText + '</option></select>';

					for (var iResults = 0; iResults < oSubCats.length; iResults++) {
						try{
							if (bOldCats==true){
								sDisplay = oSubCats[iResults].childNodes[0].childNodes[0].nodeValue;
								sValue = oSubCats[iResults].childNodes[2].childNodes[0].nodeValue;
							} else {
								sDisplay = oSubCats[iResults].childNodes[0].nodeValue;
								sValue = oSubCats[iResults].childNodes[0].nodeValue;
							}
							if (sPrepop.toLowerCase()==trim(sValue).toLowerCase()){
								bSelectedOpt = true;
								bFireNext = true;
							} else {
								bSelectedOpt = false;
							}

							document.getElementById('searchfield' + Step).options[iResults + 1] = new Option(sDisplay, sValue, bSelectedOpt);
							document.getElementById('searchfield' + Step).options[iResults + 1].title = sDisplay;

							if (bSelectedOpt==true){
								document.getElementById('searchfield' + Step).options[iResults + 1].selected = true;
							}
						}
						catch (err){
							//alert('Error in XML Loop - ' + err.message);
						}
					}
				} else {
					document.getElementById('filter_1_' + Step).innerHTML = '';
					document.getElementById('filter_1_' + Step).style.display = 'none';
				}

				EnableSearchForm1();
			}
			catch (err){
				EnableSearchForm1();
				document.getElementById('filter_1_' + Step).innerHTML = '';
				document.getElementById('filter_1_' + Step).style.display = 'none';
				//alert('Error in XML Load - ' + err.message);
			}
		} else {
			EnableSearchForm1();
			document.getElementById('filter_1_' + Step).innerHTML = '';
			document.getElementById('filter_1_' + Step).style.display = 'none';
		}

		if (bFireNext==true){
			GetSubCategories1(Step + 1);
			if ((Step==parseInt('4'))&&(bOldCats==false)){
				GetManu1();
			}
		} else {
			if (bOldCats==false){
				GetManu1();
			}
		}

		HideBlankDropdowns1();

	}

	function GetManu1(){
		DisableSearchForm1();

		var strSearchVals = '';
		var strCopyVal = '';

		for (var iSF = 1; iSF <= 4; iSF++){
			try{
				if (trim(document.getElementById('searchfield' + iSF).value)!=''){
					strCopyVal = strSearchVals;
					strSearchVals = strCopyVal = '&searchfield' + iSF + '=' + escape(trim(document.getElementById('searchfield' + iSF).value));
				}
			}
			catch (err){
				//alert(err.message);
			}
		}

		MakeSearchAJAXRequest(DrawManus1, '/pc_product_detail.asp?searchformaction=ajaxcall&searchformactiontype=getmanufacturers&usestyle=0' + strSearchVals + '&searchfield5=' + escape(trim(getSearchQueryVariable('searchfield5'))), true, [], [], false, "", xmlDoc, null, true);
	}

	function DrawManus1(xmlDoc){
		var sStepPrePop = trim(getSearchQueryVariable('searchfield5')).replace(new RegExp('%2520', 'g'), ' ');
		var sPrepop = sStepPrePop.replace(new RegExp('%20', 'g'), ' ');

		if (xmlDoc.childNodes.length > 0){
			try{
				var sSelOne = '[All Manufacturers]';

				var oManus = xmlDoc.getElementsByTagName('searchfield5');

				var sSelectOneText = sSelOne.replace(/<count>/ig, oManus.length);

				document.getElementById('filter_2_1').innerHTML = '<select name="searchfield5" id="searchfield5" class="pc-searchdrop"><option value="">' + sSelectOneText + '</option></select>';

				for (var iResults = 0; iResults < oManus.length; iResults++) {
					try{
						if (sPrepop.toLowerCase()==trim(oManus[iResults].childNodes[0].nodeValue).toLowerCase()){
							bSelectedOpt = true;
							bFireNext = true;
						} else {
							bSelectedOpt = false;
						}
						document.getElementById('searchfield5').options[iResults + 1] = new Option(oManus[iResults].childNodes[0].nodeValue, oManus[iResults].childNodes[0].nodeValue, bSelectedOpt);
						document.getElementById('searchfield5').options[iResults + 1].title = oManus[iResults].childNodes[0].nodeValue;
					}
					catch (err){
						//alert(err.message);
					}
				}

				document.getElementById('filter_2_1').style.display = 'block';
				EnableSearchForm1();
			}
			catch (err){
				EnableSearchForm1();
				try{
					document.getElementById('filter_2_1').innerHTML = '';
					document.getElementById('filter_2_1').style.display = 'none';
				} catch (err){
					//alert(err.message);
				}
				//alert(err.message);
			}
		} else {
			EnableSearchForm1();
			try{
				document.getElementById('filter_2_1').innerHTML = '';
				document.getElementById('filter_2_1').style.display = 'none';
			} catch (err){
				//alert(err.message);
			}
		}

	}

	function HideBlankDropdowns1(){
		var bShow = true;

		for (iDD = 1; iDD <= 5; iDD++){
			bShow = true;

			try{
				if (document.getElementById('searchfield' + iDD).options.length<=1){
					bShow = false;
				}

				if (bShow==false){
					switch (iDD){
						case 1:
							document.getElementById('filter_1_1').innerHTML = '';
							document.getElementById('filter_1_1').style.display = 'none';
							break;
						case 2:
							document.getElementById('filter_1_2').innerHTML = '';
							document.getElementById('filter_1_2').style.display = 'none';
							break;
						case 3:
							document.getElementById('filter_1_3').innerHTML = '';
							document.getElementById('filter_1_3').style.display = 'none';
							break;
						case 4:
							document.getElementById('filter_1_4').innerHTML = '';
							document.getElementById('filter_1_4').style.display = 'none';
							break;
						case 5:
							document.getElementById('filter_2_1').innerHTML = '';
							document.getElementById('filter_2_1').style.display = 'none';
							break;
					}
				}
			}
			catch (err){
				//alert(err.message);
			}
		}
	}

	function DisableSearchForm1(){
		document.getElementById('search_submit').disabled = true;

		try{
			document.getElementById('searchfield1').disabled = true;
		}
		catch (err){
			//alert(err.message);
		}

		try{
			document.getElementById('searchfield2').disabled = true;
		}
		catch (err){
			//alert(err.message);
		}
	
		try{
			document.getElementById('searchfield3').disabled = true;
		}
		catch (err){
			//alert(err.message);
		}

		try{
			document.getElementById('searchfield4').disabled = true;
		}
		catch (err){
			//alert(err.message);
		}

		try{
			document.getElementById('searchfield5').disabled = true;
		}
		catch (err){
			//alert(err.message);
		}

		try{
			for (var iCheck = 0; iCheck <= document.getElementsByName('searchfield6').length; iCheck++){
				try{
					document.getElementsByName('searchfield6')[iCheck].disabled = true;
				}
				catch (err){
					//alert(err.message);
				}
			}
		}
		catch (err){
			//alert(err.message);
		}


		try{
			document.getElementById('search_keyword').disabled = true;
			document.getElementById('search_string').disabled = true;
		}
		catch (err){
			//alert(err.message);
		}

		try{
			document.getElementById('search_page').disabled = true;
		}
		catch (err){
			//alert(err.message);
		}


	}

	function EnableSearchForm1(){
		document.getElementById('search_submit').disabled = false;

		try{
			document.getElementById('searchfield1').disabled = false;
		}
		catch (err){
			//alert(err.message);
		}

		try{
			document.getElementById('searchfield2').disabled = false;
		}
		catch (err){
			//alert(err.message);
		}
	
		try{
			document.getElementById('searchfield3').disabled = false;
		}
		catch (err){
			//alert(err.message);
		}

		try{
			document.getElementById('searchfield4').disabled = false;
		}
		catch (err){
			//alert(err.message);
		}

		try{
			document.getElementById('searchfield5').disabled = false;
		}
		catch (err){
			//alert(err.message);
		}

		try{
			for (var iCheck = 0; iCheck <= document.getElementsByName('searchfield6').length; iCheck++){
				try{
					document.getElementsByName('searchfield6')[iCheck].disabled = false;
				}
				catch (err){
					//alert(err.message);
				}
			}
		}
		catch (err){
			//alert(err.message);
		}


		try{
			document.getElementById('search_keyword').disabled = false;
			document.getElementById('search_string').disabled = false;
		}
		catch (err){
			//alert(err.message);
		}

		try{
			document.getElementById('search_page').disabled = false;
		}
		catch (err){
			//alert(err.message);
		}
	}

	function SetResultsPage1(){
		var aSearchInfo = document.getElementById('search_string').value.split(';');
		if (aSearchInfo.length>=2){
			try{
				document.getElementById('search_page').value = aSearchInfo[1];
			}
			catch (err){
				//alert(err.message);
			}
		}
	}

	function SubmitSearchForm1(){
		var sPrefix = '<PREFIX>';
		var sSearchField1 = '';
		var sSearchField5 = '';
		var sSearchField6 = '';
		var sSearchString = '';
		var sBreadCrumbs = '';
		var sTempCrumbs = '';
		
		var sSearchPage = 'https://winning-moves.com/pc_combined_results.asp?tab=style';
		
		var sSearchVar = 'key';

		if (bOldCats==true){
			var sPCKey = '';
			for (var iSF = 1; iSF <= 4; iSF++){
				try{
					if (document.getElementById('searchfield' + iSF).value!=''){
						sPCKey = document.getElementById('searchfield' + iSF).value;
						sTempCrumbs = sBreadCrumbs;
						sBreadCrumbs = sTempCrumbs + '&searchfield' + iSF + '=' + escape(document.getElementById('searchfield' + iSF).value);
					}
				} catch (err){
					//alert(err.message);
				}
			}

			if (sPCKey!=''){
				if ('0'=='1'){
					sSearchField1 = 'searchin~pcs.pcs_key~Product_Category_Style_Map.0.0~searchexact^pc_id^' + sPCKey;
				} else {
					sSearchField1 = 'searchin~p.p_key~Product_Category_Map.0.0~searchexact^pc_id^' + sPCKey;
				}
			}
		} else {

			try{
				if (document.getElementById('searchfield1').value!=''){
					sSearchField1 = 'searchexact~' + sPrefix + 'searchfield1~' + escape(document.getElementById('searchfield1').value);
					sBreadCrumbs = '&searchfield1=' + escape(document.getElementById('searchfield1').value);
				}
			}
			catch (err){
				//alert(err.message);
			}

			try{
				if (document.getElementById('searchfield2').value!=''){
					sSearchField1 = 'searchexact~' + sPrefix + 'searchfield1~' + escape(document.getElementById('searchfield1').value) + '|and|searchexact~' + sPrefix + 'searchfield2~' + escape(document.getElementById('searchfield2').value);			
					sBreadCrumbs = '&searchfield1=' + escape(document.getElementById('searchfield1').value) + '&searchfield2=' + escape(document.getElementById('searchfield2').value);
				}
			}
			catch (err){
				//alert(err.message);
			}

			try{
				if (document.getElementById('searchfield3').value!=''){
					sSearchField1 = 'searchexact~' + sPrefix + 'searchfield1~' + escape(document.getElementById('searchfield1').value) + '|and|searchexact~' + sPrefix + 'searchfield2~' + escape(document.getElementById('searchfield2').value) + '|and|searchexact~' + sPrefix + 'searchfield3~' + escape(document.getElementById('searchfield3').value);			
					sBreadCrumbs = '&searchfield1=' + escape(document.getElementById('searchfield1').value) + '&searchfield2=' + escape(document.getElementById('searchfield2').value) + '&searchfield3=' + escape(document.getElementById('searchfield3').value);
				}
			}
			catch (err){
				//alert(err.message);
			}

			try{
				if (document.getElementById('searchfield4').value!=''){
					sSearchField1 = 'searchexact~' + sPrefix + 'searchfield1~' + escape(document.getElementById('searchfield1').value) + '|and|searchexact~' + sPrefix + 'searchfield2~' + escape(document.getElementById('searchfield2').value) + '|and|searchexact~' + sPrefix + 'searchfield3~' + escape(document.getElementById('searchfield3').value) + '|and|searchexact~' + sPrefix + 'searchfield4~' + escape(document.getElementById('searchfield4').value);			
					sBreadCrumbs = '&searchfield1=' + escape(document.getElementById('searchfield1').value) + '&searchfield2=' + escape(document.getElementById('searchfield2').value) + '&searchfield3=' + escape(document.getElementById('searchfield3').value) + '&searchfield4=' + escape(document.getElementById('searchfield4').value);
				}
			}
			catch (err){
				//alert(err.message);
			}
		}

		try{
			if (document.getElementById('searchfield5').value!=''){
				var sTemp5 = sBreadCrumbs;
				sSearchField5 = 'searchexact~' + sPrefix + 'searchfield5~' + escape(document.getElementById('searchfield5').value);
				sBreadCrumbs = sTemp5 + '&searchfield5=' + escape(document.getElementById('searchfield5').value);
			}
		}
		catch (err){
			//alert(err.message);
		}

		try{
			var sTemp6 = '';
			var sSearchValue6 = '';
			var sTempBread6 = sBreadCrumbs;
			for (var iCheck = 0; iCheck <= document.getElementsByName('searchfield6').length; iCheck++){
				try{

					if (sSearchField6!=''){
						sTemp6 = sSearchField6;
						sSearchField6 = sTemp6 + '~' + escape(document.getElementsByName('searchfield6')[iCheck].value);			
						sSearchValue6 = sTempV6 + '~' + escape(document.getElementsByName('searchfield6')[iCheck].value);
					} else {
						sSearchField6 = 'searchlist~' + sPrefix + 'searchfield6~' + escape(document.getElementsByName('searchfield6')[iCheck].value);			
						sSearchValue6 = escape(document.getElementsByName('searchfield6')[iCheck].value);
					}
				}
				catch (err){
					//alert(err.message);
				}
			}

			if (sSearchValue6!=''){
				sBreadCrumbs = sTempBread6 + '&searchfield6=' + escape(sSearchValue6);
			}

		}
		catch (err){
			//alert(err.message);
		}

		var bSearchString = true;
		var sTempKeyword = sBreadCrumbs;
		var sTempSearchPage = sSearchPage;

		try{
			// check for default text in keyword field
			if (document.getElementById('search_keyword').value == 'Search') {
				document.getElementById('search_keyword').value = '';
			}
		} catch (err){
			//alert(err.message);
		}
		
		try{
			if (trim(document.getElementById('search_keyword').value)!=''){
				if (document.getElementById('search_string')==null){
					bSearchString = false;
					if (document.getElementById('valid_input').value=='0'){
						sSearchString = trim(document.getElementById('search_keyword').value);
					} else {
						sSearchString = trim(document.getElementById('valid_key').value);
					}
				} else {
					var aSearchInfo = document.getElementById('search_string').value.split(';');
					sSearchString = aSearchInfo[0].replace(new RegExp('<Keyword>', 'gi'), trim(document.getElementById('search_keyword').value));
					var sTempSS = sSearchString.replace(new RegExp('<Length>', 'gi'), trim(document.getElementById('search_keyword').value).length);
					sSearchString = sTempSS;

					try{
						sTempSearchPage = aSearchInfo[1];
					}
					catch (err){
						sTempSearchPage = sSearchPage;
						//alert(err.message);
					}
				}

				sBreadCrumbs = sTempKeyword + '&search_keyword=' + escape(trim(document.getElementById('search_keyword').value));
			}
		}
		catch (err){
//			alert(err.message);
		}

		try{
			if (trim(document.getElementById('search_page').value)!=''){
				sSearchPage = trim(document.getElementById('search_page').value);
			} else {
				sSearchPage = sTempSearchPage;
			}
		}
		catch (err){
			sSearchPage = sTempSearchPage;
			//alert(err.message);
		}

		var sCombinedSearch = '';
		var sTempSearch = '';

		if (sSearchField1!=''){
			sCombinedSearch = '(' + sSearchField1 + ')';
		}

		if (sSearchField5!=''){
			if (sCombinedSearch!=''){
				sTempSearch = sCombinedSearch;
				sCombinedSearch = sTempSearch + '|and|(' + sSearchField5 + ')';
			} else {
				sCombinedSearch = '(' + sSearchField5 + ')';
			}
		}

		if (sSearchField6!=''){
			if (sCombinedSearch!=''){
				sTempSearch = sCombinedSearch;
				sCombinedSearch = sTempSearch + '|and|(' + sSearchField6 + ')';
			} else {
				sCombinedSearch = '(' + sSearchField6 + ')';
			}
		}

		if (bSearchString==true){
			if (sSearchString!=''){
				var sCatSearch = '';
				var sStyleSearch = '';
				var sProdSearch = '';
				var sCombinedSS = '';

				var aSearching = sSearchString.split('&');

				for (var iSS = 0; iSS < aSearching.length; iSS++){
					switch (aSearching[iSS].substring(0, 10)){
						case 'search_cat':
							try{
								sCatSearch = aSearching[iSS] + '|and|' + sCombinedSearch;

								if (sCombinedSS!=''){
									sTempSearch = sCombinedSS;
									sCombinedSS = sTempSearch + '&' + (sCatSearch);
								} else {
									sCombinedSS = (sCatSearch);
								}
							}
							catch (err){
								//alert('search_cat - ' + err.message);
							}

							break;
						case 'search_sty':
							try{
								sStyleSearch = aSearching[iSS] + '|and|' + sCombinedSearch.replace(new RegExp('<PREFIX>', 'gi'), 'pcs.');

								if (sCombinedSS!=''){
									sTempSearch = sCombinedSS;
									sCombinedSS = sTempSearch + '&' + (sStyleSearch);
								} else {
									sCombinedSS = (sStyleSearch);
								}
							}
							catch (err){
								//alert('search_sty - ' + err.message);
							}

							break;
						case 'search_pro':
							try{
								sProdSearch = aSearching[iSS] + '|and|' + sCombinedSearch.replace(new RegExp('<PREFIX>', 'gi'), 'p.');

								if (sCombinedSS!=''){
									sTempSearch = sCombinedSS;
									sCombinedSS = sTempSearch + '&' + (sProdSearch);
								} else {
									sCombinedSS = (sProdSearch);
								}
							}
							catch (err){
								//alert('search_pro - ' + err.message);
							}

							break;
						default:
							break;
					}
				}
				sCombinedSearch = sCombinedSS;
			} else {
				sTempSearch = sCombinedSearch;
				sCombinedSearch = 'search_style=' + (sTempSearch) + '&search_prod=' + (sTempSearch);
			}
		} else {
			sCombinedSearch = sSearchVar + '=' + (sSearchString);
		}

		if (sCombinedSearch!=''){
			sTempSearch = sCombinedSearch;
			sCombinedSearch = sTempSearch.replace(new RegExp('<PREFIX>', 'gi'), 'p.');
		}

		var sConcat = '?';

		if (sSearchPage.indexOf('?')>=0){
			sConcat = '&';
		}

		
			window.location = sSearchPage + sConcat + sCombinedSearch + sBreadCrumbs;
		
	}

	function AdvEnterDisable1(myfield, e){
		var key;
		var keychar;

		if (window.event)
		   key = window.event.keyCode;
		else if (e)
		   key = e.which;
		else
		   return true;
		keychar = String.fromCharCode(key);

		if (key==13)
			return false;

		else
			return true;
	}

	/************************************************************************************
	*** START XML/AJAX FUNCTIONS ********************************************************
	************************************************************************************/

	function createSearchXMLDoc(XMLFile) {
		// code for IE
		if (window.ActiveXObject){
			xmlDoc = new ActiveXObject("Microsoft.XMLDOM");
			xmlDoc.loadXML(XMLFile);
		// code for Mozilla, Firefox, Opera, etc.
		} else if (document.implementation && document.implementation.createDocument){
			var parser = new DOMParser();
			var xmlDoc = parser.parseFromString(XMLFile, "text/xml");
		} else {
			alert('Your browser cannot handle this script.');
		}

		return(xmlDoc);
	}

	function loadSearchXMLDoc(XMLFile) {
		// code for IE
		if (window.ActiveXObject){
			xmlDoc = new ActiveXObject("Microsoft.XMLDOM");
			xmlDoc.async="false";
			xmlDoc.load(XMLFile);
		// code for Mozilla, Firefox, Opera, etc.
		} else if (document.implementation && document.implementation.createDocument){
			var xmlDoc = document.implementation.createDocument("","",null);
			xmlDoc.async="false";
			xmlDoc.load(XMLFile);
		} else {
			alert('Your browser cannot load "' + XMLFile + '"'); 
		}

		return(xmlDoc);
	}

	function serializeSearchXML(XMLObj){
		var strXML = '';

		// code for IE
		if (window.ActiveXObject){
			strXML = XMLObj.xml;
		// code for Mozilla, Firefox, Opera, etc.
		} else if (document.implementation && document.implementation.createDocument){
			//xmlDoc = document.implementation.createDocument("", "", null);
			strXML = (new XMLSerializer()).serializeToString(XMLObj);
		} else {
			alert('Your browser cannot serialize this script.');
		}

		return(strXML);
	}

	function getSearchXMLNodeValue(xmlDoc, tagName, index) {
		if (xmlDoc.getElementsByTagName(tagName)[index].childNodes[0] != null)
			return xmlDoc.getElementsByTagName(tagName)[index].childNodes[0].nodeValue;
		else
			return '';
	}

	// Create an XMLHttpRequest object
	function GetSearchXMLHttpObject() {
		var xmlHttp = null;
		try {
			// Firefox, Opera 8.0+, Safari
			xmlHttp = new XMLHttpRequest();
		} catch (e) {
			// Internet Explorer
			try {
				xmlHttp = new ActiveXObject("Msxml2.XMLHTTP");
			} catch (e) {
				xmlHttp = new ActiveXObject("Microsoft.XMLHTTP");
			}
		}
		return xmlHttp;
	}

	function MakeSearchAJAXRequest(fncHandleSearchData, strPage, bAsync, aShow, aHide, bDisable, errorMsg, xmlDoc, vID, bDebug) {
		xmlHttp = GetSearchXMLHttpObject();
		if (xmlHttp==null){
			alert ("Your browser does not support AJAX.");
			return;
		}

		if (bDisable == null){
			bDisable = false;
		}

		var i;

		try{
			if (aShow != null){
				for (i = 0; i < aShow.length; i++){
					if (bDisable==true){
						document.getElementById(aHide[i]).disabled = false;
					} else {
						document.getElementById(aShow[i]).style.display = 'block';
					}
				}
			}		
		}
		catch (err){
			//alert(err.message);
		}

		try{
			if (aHide != null){
				for (i = 0; i < aHide.length; i++){
					if (bDisable==true){
						document.getElementById(aHide[i]).disabled = true;
					} else {
						document.getElementById(aHide[i]).style.display = 'none';
					}
				}
			}
		}
		catch (err){
			//alert(err.message);
		}


		if (((getSearchQueryVariable('action')=='showpostfield')||(getSearchQueryVariable('showpostfield')=='1')||(getSearchQueryVariable('action')=='showsql'))&&(bDebug)){
			window.open(strPage + '&r_id=' + genID());
		}

		xmlHttp.open('get', strPage + '&r_id=' + genID(), bAsync);
		xmlHttp.onreadystatechange = function() { HandleSearchData(fncHandleSearchData, errorMsg, vID, true) };
		if (xmlDoc == undefined){
			xmlDoc = null;
		}
		xmlHttp.send(xmlDoc);
	}

	function HandleSearchData(fncHandleSearchData, errorMsg, vID, vReturnXML) {
		var sError = 'An error has occured.';

		try{
			if (errorMsg != undefined && errorMsg != '' && errorMsg != null && typeof(errorMsg) != 'object'){
				sError = errorMsg;
			}
		}
		catch (err){
			//alert(err.message);
		}

		if(xmlHttp.readyState == 4) { //Finished loading the response

			if (vReturnXML==true){
				xmlDoc = createSearchXMLDoc(xmlHttp.responseText);
			} else {
				var strResponse = xmlHttp.responseText;
			}

			if (xmlDoc == null && vReturnXML==true)	{
//				alert(sError);
			} else {
				if (vReturnXML==true){
					fncHandleSearchData(xmlDoc, vID);
				} else {
					fncHandleSearchData(strResponse, vID);
				}
			}

		}
	}

	function getSearchQueryVariable(vQSVar) {
		var strReturn = '';
		var strQuery = window.location.search.substring(1);
		var aVars = strQuery.split('&');
		for (var iVar = 0; iVar < aVars.length; iVar++) {
			var aQS = aVars[iVar].split('=');
			if (trim(aQS[0]).toLowerCase()==trim(vQSVar).toLowerCase()) {
				strReturn = trim(aQS[1]);
				break;
			}
		}

		return strReturn;
	}

	// Generate 32 character hex ID
	function genID() {
		var id = "";
		var i;
		for (i = 0; i < 32; i++) {
			id = id + dec2hex(Math.round(16*Math.random()));
		}
		return id;
	}


	// Create an XMLHttpRequest object
	function createRequestObject(){
		var request_o;
		var browser = navigator.appName;
		if(browser == "Microsoft Internet Explorer"){
			request_o = new ActiveXObject("Microsoft.XMLHTTP");
		}else{
			request_o = new XMLHttpRequest();
		}
		return request_o;
	}
	
	// Decimal to Hexadecimal
	function dec2hex(dec) {
		var hD="0123456789ABCDEF";
		var hex = hD.substr(dec&15,1);
		while (dec>15) {
			dec >>= 4;
			hhex = hD.substr(dec&15,1) + hex;
		}
		return hex;
	}

	// Hexadecimal to Decimal
	function hex2ddec(hex) {
		return parseInt(hex,16);
	} 

	function trim(stringToTrim) {
		return stringToTrim.replace(/^\s+|\s+$/g,"");
	}

	function getSearchNodeValue(xmlDoc, tagName, index) {
		try{
			if (xmlDoc.getElementsByTagName(tagName)[index].childNodes[0] != null){
				return xmlDoc.getElementsByTagName(tagName)[index].childNodes[0].nodeValue;
			} else {
				return '';
			}
		}
		catch (err){
			//alert(err.message);
			return 'Error Loading Search Node';
		}
	}

	/************************************************************************************
	*** END XML/AJAX FUNCTIONS **********************************************************
	************************************************************************************/

	
</script>
					</div><!-- End Content Header -->
					<div id="content_padding">

	<script language="JavaScript" src="common_images/scripts/super_calendar.js"></script>
<script language="JavaScript">
	document.write(getCalendarStyles());
	function moveiFrame(iCal){
		try
		{
			var myframe = document.getElementById('cal_frame')
			var myCal = eval('cal_' + iCal)
			myframe.style.zIndex = 99;
			myframe.style.left = myCal.x;
			myframe.style.top = myCal.y;
		}
		catch (err)
		{
			//alert(err.message);
		}
	}
</script><style>
.cpYearNavigation,.cpMonthNavigation { background-color:#C0C0C0; text-align:center; vertical-align:center; text-decoration:none; color:#000000; font-weight:bold; }
.cpDayColumnHeader, .cpYearNavigation,.cpMonthNavigation,.cpCurrentMonthDate,.cpCurrentMonthDateDisabled,.cpOtherMonthDate,.cpOtherMonthDateDisabled,.cpCurrentDate,.cpCurrentDateDisabled,.cpTodayText,.cpTodayTextDisabled,.cpText { font-family:arial; font-size:8pt; }
TD.cpDayColumnHeader { text-align:right; border:solid thin #C0C0C0;border-width:0px 0px 1px 0px; }
.cpCurrentMonthDate, .cpOtherMonthDate, .cpCurrentDate  { text-align:right; text-decoration:none; }
.cpCurrentMonthDateDisabled, .cpOtherMonthDateDisabled, .cpCurrentDateDisabled { color:#D0D0D0; text-align:right; text-decoration:line-through; }
.cpCurrentMonthDate, .cpCurrentDate { color:#000000; }
.cpOtherMonthDate { color:#808080; }
TD.cpCurrentDate { color:white; background-color: #C0C0C0; border-width:1px; border:solid thin #800000; }
TD.cpCurrentDateDisabled { border-width:1px; border:solid thin #FFAAAA; }
TD.cpTodayText, TD.cpTodayTextDisabled { border:solid thin #C0C0C0; border-width:1px 0px 0px 0px;}
A.cpTodayText, SPAN.cpTodayTextDisabled { height:20px; }
A.cpTodayText { color:black; }
.cpTodayTextDisabled { color:#D0D0D0; }
.cpBorder { border:solid thin #808080; }
</style>

<!--IFRAME IE HACK to cover SELECT dropdown list boxes. Iframe needs to be resized for menu height and width. -->
<div id="scal_popup" style="z-index:100;position: absolute; visibility: hidden; background-color: #fff; layer-background-color: #fff;"></div>
<!-- Width is +4 of the calendar's width to account for the border -->
<iframe id="cal_frame" src="javascript:'';" marginwidth="0" marginheight="0" align="bottom" scrolling="no" frameborder="0" style="z-index:-100;position:absolute; left:0; top:0px; width:154; height:175; display:block; filter:alpha(opacity=0);-moz-opacity: 0.80;opacity: 0.80;">
</iframe>
<script language="JavaScript" src="common_images/scripts/Catalog Builder/catalog_builder__100.0.01.js"></script>


<script language="Javascript" type="text/javascript">
	function SubmitFormOnChange(vID, vURLVar){
		var sQS = BuildQueryString(vURLVar);
		var sPage = '';
 
		if (sPage != '') {
			sQS = sQS.replace('page=' + sPage,'page=1');
		}

		if (sQS=='' || sQS=='?'){
			if (sQS=='') {	
				sQS = '?' 
			}

			sQS += vURLVar + '=' + document.getElementById(vID).value;
		} else {
			var sTempQS = sQS;
			sQS = sTempQS + '&' + vURLVar + '=' + document.getElementById(vID).value;
		}

		window.location = 'https://winning-moves.com//pc_product_detail.asp' + sQS;
	}

	function BuildQueryString(vRemove){
		var sQS = 'rewrite=true&key=79CA3421E53B4167AABDE2C1136CA5DA';
		var aQS = sQS.split('&');

		var sOutput = '';
		var sTempString = '';
		var aQSVar;

		for (var iVar = 0; iVar < aQS.length; iVar++){
			aQSVar = aQS[iVar].split('=');
			if (trim(aQSVar[0]).toLowerCase()!=trim(vRemove).toLowerCase()){
				sTempString = sOutput;
				if (sOutput==''){
					sOutput = '?' + aQS[iVar];
				} else {
					sOutput = sTempString + '&' + aQS[iVar];
				}
			}
		}

		return sOutput;
	}

	function BuildQueryArray(vRemove){
		var sQS = 'rewrite=true&key=79CA3421E53B4167AABDE2C1136CA5DA';
		var aQS = sQS.split('&');

		var sOutput = '';
		var sTempString = '';
		var aQSVar;

		var aQA = new Array();

		for (var iVar = 0; iVar < aQS.length; iVar++){
			aQSVar = aQS[iVar].split('=');
			if (trim(aQSVar[0]).toLowerCase() in ObjConvert(vRemove)){
				//Do Nothing
			} else {
				sTempString = sOutput;
				if (sOutput==''){
					aQA[aQA.length] = aQS[iVar];
				}
			}
		}

		return aQA;
	}

	function FilterWithin(vID){
		var aQueryString;

		var sGroupBy = ''
		var sGroupByVar = '';
		var sPageName = 'https://winning-moves.com//pc_product_detail.asp';
		var sQS = '';
		var sRPP = '';
		var sRPPVar = '';
		var sSortBy = '';
		var sSortByVar = '';
		var sTempString = '';

		try{
			sGroupBy = trim(document.getElementById('groupbyqs' + vID).value) + '=' + trim(document.getElementById('groupby' + vID).value);
			sGroupByVar = trim(document.getElementById('groupbyqs' + vID).value);
		}
		catch (err){
			//alert(err.message);
		}

		try{
			sRPP = trim(document.getElementById('rppqs' + vID).value) + '=' + trim(document.getElementById('rpp' + vID).value);
			sRPPVar = trim(document.getElementById('rppqs' + vID).value);
		}
		catch (err){
			//alert(err.message);
		}

		try{
			sSortBy = trim(document.getElementById('sortbyqs' + vID).value) + '=' + trim(document.getElementById('sortby' + vID).value);
			sSortByVar = trim(document.getElementById('sortbyqs' + vID).value);
		}
		catch (err){
			//alert(err.message);
		}

		aQueryString = BuildQueryArray(Array('page', sGroupByVar, sRPPVar, sSortByVar));

		for (iQS = 0; iQS < aQueryString.length; iQS++){
			sTempString = sQS;
			if (sQS==''){
				sQS = '?' + aQueryString[iQS];
			} else {
				sQS = sTempString + '&' + aQueryString[iQS];
			}
		}

		if (sGroupBy!=''){
			sTempString = sQS;
			if (sQS==''){
				sQS = '?' + sGroupBy;
			} else {
				sQS = sTempString + '&' + sGroupBy;
			}
		}		

		if (sRPP!=''){
			sTempString = sQS;
			if (sQS==''){
				sQS = '?' + sRPP;
			} else {
				sQS = sTempString + '&' + sRPP;
			}
		}		

		if (sSortBy!=''){
			sTempString = sQS;
			if (sQS==''){
				sQS = '?' + sSortBy;
			} else {
				sQS = sTempString + '&' + sSortBy;
			}
		}		

		window.location = sPageName + sQS;

	}

	function ObjConvert(aArray){
		var oObj = {};

		for(var iCount = 0; iCount < aArray.length; iCount++){
			oObj[trim(aArray[iCount]).toLowerCase()]='';
		}

		return oObj;
	}

	function trim(stringToTrim) {
		return stringToTrim.replace(/^\s+|\s+$/g,'');
	}

</script>
<script language="javascript" src="common_images/scripts/wz_tooltip.js"></script><!-- include files here -->

<script type="text/javascript">
    // Put this here to avoid JS error
    function fncToggleComments(sSelectID, sHTMLID, sConfigKey, iRowID){
        try {
            if ( $('#' + sSelectID + ' option:selected').text().substring(0, 4).toLowerCase()=='misc' || $('#' + sSelectID + ' option:selected').text().substring(0, 2).toLowerCase()=='zz'){
                $('#' + sHTMLID + '_commentsbox').fadeIn();
            } else {
				$('#' + sHTMLID + '_commentsbox').hide();
                $('#' + sHTMLID + '_comments').val('');

				buildCartOptWithComments(sConfigKey,'',iRowID);				
            }
        } catch(err) {
            //alert(err.message);
        }
    }

</script>
<!-- include files here -->


	<script type="text/javascript" language="JavaScript">
		// XMLHttpRequest Object
		var xmlHttp;
		var xmlDoc;

		/*
		 * Stores child products of this parent
		 *
		 * Each property of oChildProds is the primary key
		 * of a child product and stores an object defining
		 * that child product.
		 *
		 * @var object
		 */
		var oChildProds = {};

	</script>
		
		<div id="detail_wrap">
		
			<form name="frmAddToCart" id="frmAddToCart" class="frmAddToCart" method="POST" action="https://winning-moves.com/i_i_add_to_cart.asp?type=v200add&amp;sc_id=02D4C80E8BD34C109776A02D1C0EE210&amp;a_name=&amp;c_Lastname=&amp;c_firstName=&amp;c_userName=&amp;c_id=&amp;a_id=&amp;s_key=4466EC0C5F144591BCF653D761706A33&amp;s_url=https%3A%2F%2Fwinning%2Dmoves%2Ecom&amp;o_url=https%3A%2F%2Fwinning%2Dmoves%2Ecom&amp;createsessioncookie=1&amp;noredirect=1&amp;l_ws_key=&amp;c_type=&amp;SessionPriceGroup=&amp;SessionWarehouse=&amp;SessionCurrency=&amp;SessionPriceSheetField=&amp;user_setting_key=&amp;us_key=&amp;mobile=no" onsubmit="return postToCart();">
		
					<div id="atc_msg_container" style="display:none;" class="atc_msg overlay"></div>
					<div id="atc_msg" style="display:none;" class="atc_msg message">
						<div id="atc_msg_text">The following item has been added to your shopping cart:</div>
						<div id="atc_msg_product"></div>
						<ul id="atc_msg_buttons" style="display:none;">
							<li id="atc_msg_btn1"><a class="btn" id="atc_msg_close_win" href="https://winning-moves.com/product/crazycanoe.asp#">Close</a></li>
							<li id="atc_msg_btn2"><a class="btn" id="atc_msg_view_cart" href="https://winning-moves.com/showcart.asp?sc_id=02D4C80E8BD34C109776A02D1C0EE210&amp;a_name=&amp;c_Lastname=&amp;c_firstName=&amp;c_userName=&amp;c_id=&amp;a_id=&amp;s_key=4466EC0C5F144591BCF653D761706A33&amp;s_url=https%3A%2F%2Fwinning%2Dmoves%2Ecom&amp;o_url=https%3A%2F%2Fwinning%2Dmoves%2Ecom&amp;createsessioncookie=1&amp;noredirect=1&amp;l_ws_key=&amp;c_type=&amp;SessionPriceGroup=&amp;SessionWarehouse=&amp;SessionCurrency=&amp;SessionPriceSheetField=&amp;user_setting_key=&amp;us_key=&amp;mobile=no">View Cart</a></li>
						</ul>
						<div id="atc_msg_notice">
							
						</div>
					</div>
					
					
					
					<div id="dialog-box"></div>

					<div class="loading-bg" id="detailloadingbg" style="display:none;">&nbsp;</div>
					<div class="loading-win bgfade" id="detailloadingpic" style="display:none;">
						<img src="templates/gfx/ajax-loader.gif"> Processing your selection. Please wait...
					</div>
					
					
								
		
					<h1 id="detail_parent_prod_nm" class="detail_title">Crazy Canoeâ„¢</h1>
					
						<div id="share_code"> <div id="add_this_productdetail"><!-- AddThis Button BEGIN --><div class="addthis_toolbox addthis_default_style "><a class="addthis_button_preferred_1"></a><a class="addthis_button_preferred_2"></a><a class="addthis_button_preferred_3"></a><a class="addthis_button_preferred_4"></a><a class="addthis_button_compact"></a><a class="addthis_counter addthis_bubble_style"></a></div><script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid=xa-4e70ee5f6d646fd0"></script></div></div>
		
					<div class="detail_photo clearfix">

							<div id="detail_photo_container">
									<img src="images/1264_CrazyCanoeLrg.jpg" id="prodpicthumb" name="prodpic" alt="Crazy Canoe&amp;trade;">
								
							</div><!--#detail_photo_container-->
							<div id="short_ds_container">
								<span></span>
							 </div>
						
								
					</div><!--/.detail_photo-->		
					
					<div class="detail_cart"><div id="pw_table"></div>
				<div class="detail_desc">
					<!--<h2>Description</h2>-->
					<div class="detail_desc_content" id="detail_desc_content_0"><p>You're packing for your family camping trip and need to fit all your gear into your canoe.</p>
<p>It's a delicate balancing act to keep the Crazy Canoe afloat. Steady your hand carefully slot a piece onto the ever growing stack. Lookout! You don't want anything to drop into the river! Any pieces that fall off during a turn go back to the palyer who caused a spill. Once a player has successfully stacked all their gear into the Crazy Canoe, they need to get Finn, the family dog, balanced safely on top for the win!</p>

<iframe width="420" height="315" src="https://www.youtube.com/embed/ytOHYJjOGDE?si=kCfDYrPlmWxf7_p4" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen=""></iframe></div>
				</div><div id="idp_container"> <div class="idp_container inv_msg">
						<span class="instock"></span> 
						
					</div> </div>
						
						<input type="hidden" name="parent_prod" id="parent_prod" value="">
						
						
					</div><!-- .detail_cart -->
						<div class="detail_info_container">
						<h2>Additional Info </h2>
						<ul class="detail_info" id="detail_info_sf">
								<li id="detail_info_sf11"><span>Ages:</span><span class="additional_details">8 and up</span></li>
								<li id="detail_info_sf12"><span>Players:</span><span class="additional_details">2 to 4</span></li>
								<li id="detail_info_sf13"><span>Contents:</span><span class="additional_details">52 Sturdy Cardboard Pieces of Camping Gear, 1 Plastic Canoe, 1 Finn Dog Piece, 1 River Board, Illustrated Instructions</span></li>

						</ul>

					</div>	
		
			<div class="detail_related clearfix">

				<h2>Suggested Products</h2>

				<ul class="prod_grid_list">
						
						<li>
							
								<div class="thumb"><a href="product/PassThePigs.asp" title="Pass The PigsÂ®"><img src="images/PTP_Small2017.jpg" alt="Pass The PigsÂ®"></a></div>

							<div class="item_row nm"><a href="product/PassThePigs.asp" title="Pass The Pigs&amp;#174;">Pass The PigsÂ®</a></div>
										<div class="item_row retailprice">$17.95</div>
						</li>
						
						<li>
							
								<div class="thumb"><a href="product/guesswho.asp" title="Guess Who?Â® Classic Edition"><img src="images/1191_GuessWho_2024sml.jpg" alt="Guess Who?Â® Classic Edition"></a></div>

							<div class="item_row nm"><a href="product/guesswho.asp" title="Guess Who?&amp;reg; Classic Edition">Guess Who?Â® Classic Edition</a></div>
										<div class="item_row retailprice">$25.95</div>
						</li>
						
						<li>
							
								<div class="thumb"><a href="product/InstantInsanity.asp" title="Instant InsanityÂ®"><img src="images/1256_instantInsanity_small.jpg" alt="Instant InsanityÂ®"></a></div>

							<div class="item_row nm"><a href="product/InstantInsanity.asp" title="Instant Insanity&amp;#174;">Instant InsanityÂ®</a></div>
										<div class="item_row retailprice">$7.50</div>
						</li>
						
						<li>
							
								<div class="thumb"><a href="product/Rack-O.asp" title="Rack-OÂ®"><img src="images/6122_Racko_2024_sml.jpg" alt="Rack-OÂ®"></a></div>

							<div class="item_row nm"><a href="product/Rack-O.asp" title="Rack-O&amp;#174;">Rack-OÂ®</a></div>
										<div class="item_row retailprice">$19.95</div>
						</li>
				
				</ul>

			</div>
			</form>
		
		</div><!--#detail_wrap-->

	<div id="debug_messages"></div>
		<script type="text/javascript" src="common_images/scripts/ajax_builder/ajax_builder__100_00_06.js"></script>

	<script type="text/javascript">
		
		/*
		 * AJAX Builder object
		 *
		 * @var object
		 */
		var oAjax 					= new ajax_builder();

		/*
		 * Sales UOM vars
		 */
		var bShowSalesUOM 			= false;
		var bOnlyShowSalesUOM 		= false;
		var bShowAdditionalSalesUOM = false;

		var bShowQtyPerUnitColumn 	= true;
		var bShowRating 			= true;
		var bShowCartOpts 			= false;
		var bCartOptionsRqd 		= false;
		var bShowPriceDisplayType	= false;
		var bShowBackOrderMessage 	= false;
		var bShowPriceCompare		= true;
		var bUseChildPics			= false;
		var bUseChildDocs			= false;
		var bUseChildCartOpts		= false;
		var bShowChildQtyPricing	= false;
		var bUseChildDescription	= false;
		var bShowInvWatchLink		= false;
		var bUseProductAliases		= false;
		var bShowInvByWarehouse		= false;
		var bShowAreaWeightSection  = false;
		var bShowParentAddonProds	= false;
		var bShowChildAddonProds	= false;
		var bUseCaseQty				= false;
		var bUseChildCaseQty		= false;
		
		/*
		 * Get the value of property
		 * @auther	vinayakj
		 * @since	5/5/2011
		 */
		var bShowHazmatRatio = false;	

		 
			var bReviewsEOF 		= true;
		


		var sParentType 					= '0';
		var sChildDisplay 					= '';
		var sCartOptions 					= '';
		var sPKey 							= '79CA3421E53B4167AABDE2C1136CA5DA'; //p_key from the querystring
		var sAvgRatingLabel 				= 'Average Rating:';
		var sPriceDisplayType				= '';
		var sPriceMessage					= 'Call for Price.';
		var sShowPriceDisplayTypeDropList 	= false;
		var sHelpText						= '<b>Add to Cart to See Price!</b> Our pricing on this product is below the manufacturers authorized price. For this reason, you have to add the product to the shopping cart to see the price.';
		var sHelpTextLogin					= 'This product requires you to log in to see a price or add the product to your shopping cart.';
		var sLargePic						= 'common_images/spacer.gif';
		var sDetailPic						= 'images/1264_CrazyCanoeLrg.jpg';	
		var sUnitPriceColumnLabel 			= 'Unit Price';
		var sQtyPricingLinkLabel			= 'Qty Pricing';
		var sCaseQtyText					= 'Available in cases of <qty>';

		var iAvgRating;
		var iTotal 							= 0;
		var iTotalRecords 					= 0;
		var iMaxRating 						= 5;


		var sGlobalBackOrderMessage 		= '';
		var dShowTabs 						= false;

		var sStockExceedMessage    			= 'The item you have requested exceeds the quantity available';
		var sStockAvailableMessage 			= 'Requested quantity is currently available';

		var sBackorderPlacedMessage 		= 'Item(s) will be placed on backorder';
		var sBackorderAvailabeMessage 		= 'Item(s) added to Cart';
		var bShowProdConfig 				= 'false'

		var bUseAddonProducts 				= false;
		var bShowFavoriteLink				= false;
		var bShowChildFavoriteLink			= false;
		var bShowPWSelection				= false;

		/*
		 *Code to calculate Area and Weight based on qty input and show it onto the screen.
		 *@author pijushb
		 *@since 4/11/2012
		 **/
		if (bShowAreaWeightSection)
		{
		  jQuery(function(){
			$('#qty_box').change(function(event){
				sQty = this.value;
				//If Area hidden input created then only calculate and show the values onto screen.
				if ($('#area_'+sPKey)[0])
				{
					sArea = $('#area_'+sPKey).val();
					sTotalArea = parseFloat(sQty) * parseFloat(sArea)
					$('#area').html("<span>Area/Volume:</span>"+sArea +' sq ft x '+ sQty + ' = <strong>' + sTotalArea + ' sq ft</strong>');
				}
				//If Weight hidden input created then only calculate and show the values onto screen.			
				if ($('#weight_'+sPKey)[0])
				{
					sWeight = $('#weight_'+sPKey).val();
					sTotalWeight = parseFloat(sQty) * parseFloat(sWeight)
					$('#weight').html("<span>Weight:</span>"+sWeight+' lbs x '+ sQty + ' = <strong>' + sTotalWeight + ' lbs</strong>');
				}
			}); //$('#qty_box').change(function(event)

		  }); // jQuery(function(){
		} //if (bShowAreaWeightSection)


	/*
		 *Activate tabs section
		 *@author pijushb
		 *since 12/14/2011
		 */
		
		if (dShowTabs)
		{
		
			$(function() {
				try
				{
					$( "#tabs" ).tabs();					
				}
				catch (err)
				{ //ignore.. may not be used
				}
			});
		}

		if (iTotalRecords != 0) {
			iAvgRating = (iTotal / iTotalRecords);
			iAvgRating = iAvgRating.toFixed(1);
		}


		if (iTotalRecords != 0) {
			iAvgRating = (iTotal / iTotalRecords);
			iAvgRating = iAvgRating.toFixed(1);
		}
		
		/**
		 * Execute After DOM Load
		 */
		if (bShowBackOrderMessage) {
		
			jQuery(function(){
				
				/**
				 * Add To Cart Processing w/ Inventory Check
				 * @author	pijushb
				 * @since	9/9/2011
				 */
				(function($){
					
					$("#review_button").hide();
					
					$('#check_stock_button').click(function(event){
					
					    event.preventDefault();
						var bQtyRequestedAvailable = checkAvailableQty("checkbtn");
						sPreviousSku = jQuery("#keys").val();
						$("#previous_sku").val(sPreviousSku);
						keys = document.getElementsByName('keys');
						for (var k=0; k < keys.length; k++){
							$("#review_message_"+keys[k].value).show();
						}
						
					});

					//Register submit button listener
					$('#submit_button').click(function(event){
						
						var bQtyRequestedAvailable = checkAvailableQty("addcartbtn");
						keys = document.getElementsByName('keys');
						event.preventDefault();
					
					});

					/**
					 * Add function to get message warning for avaliable quantity and back order qty.
					 * @author	pijushb
					 * @since	9/9/2011
					 */
					function checkAvailableQty(sBtnFrom) {
					
						try {
								var bAvaliable = false;
								var qtyRequested, sPkey, sBackOrderMessage
								keys = document.getElementsByName('keys');
								bQtyInput = false;
								// Check for empty qty and user click on ATC Button.
								for(iKey=0; iKey < keys.length; iKey++)
								{
									if (document.getElementById('qty_box')){
										sQtyRequested = document.getElementById('qty_box').value;
									}
									else{
										sQtyRequested = document.getElementById('qty_'+keys[iKey].value).value;
									}
									
									if (sQtyRequested>0)
									{
									  bQtyInput = true;
									}
								}

								if (!bQtyInput)
								{
								   $("#dialog-box").html("Please input quantity for product you need to purchase.")
								   $("#dialog-box").dialog();
								   return false;
								}
								
								// Check for input qty and set the message.
								var sBackOrderMessage ="";
								for (var k=0; k < keys.length; k++){
									
									if (document.getElementById('qty_box')){
										sQtyRequested = document.getElementById('qty_box').value;
									}
									else{
										sQtyRequested = document.getElementById('qty_'+keys[k].value).value;
									}
									
									iQtyAvaliable = document.getElementById('qty_available_' + keys[k].value).value
									
									if (sQtyRequested>0)
									{
										if (parseInt(sQtyRequested) > parseInt(iQtyAvaliable))
										{
											iBackOrderQty = parseInt(sQtyRequested) - parseInt(iQtyAvaliable);
											// Replace backorder message
											if (sBtnFrom === "addcartbtn")
											{
												sBackOrderMessage  = sBackorderPlacedMessage
											}
											bAvaliable = false;
										}
										else
										{
											sBackOrderMessage  = sBackorderAvailabeMessage
											bAvaliable = true;
											
										}//if (parseInt(sQtyRequested) > parseInt(iQtyAvaliable))

										if (sBtnFrom === "checkbtn")
										{
										   if (bAvaliable)
											 jQuery("#review_message_"+keys[k].value).html(sStockAvailableMessage);
										   else
											 jQuery("#review_message_"+keys[k].value).html(sStockExceedMessage);
										} //if (sBtnFrom === "checkbtn")
									
									} //if (sQtyRequested>0)

								} //for (var k=0; k < keys.length; k++)
									
								//If the qty requested is available, add to cart
								if (bAvaliable && sBtnFrom === "addcartbtn") {
									showOkCheckoutMessage(sBackOrderMessage);
									return true;
								}
								else
								{
									if (sChildDisplay == "input-qty" && sBtnFrom === "addcartbtn")
									{
										showOkCheckoutMessage(sBackOrderMessage);
									}
									else if (sBtnFrom === "addcartbtn")
									{
										showOkCheckoutMessage(sBackOrderMessage);
									}
									
									return false;
								}
							
						}
						catch(err)
						{
							alert('Error: ' + err.message);
							return false;
						}

					}
					/**
					 * Show a modal message
					 * @author pijushb
					 * @since 9/9/2011
					 */
					function showModalMessage(sMessage){
							ResizeLoadingBG();
							sOrigText = $('#detailloadingpic').html();
							$('#detailloadingpic').html(sMessage);
							setTimeout( 'HideLoadingMessage(sOrigText)', 3000 );
							
					}

					/*
					 * Function to popup dialog box with proper message
					 * @author pijushb
					 * @since 1/25/2012
					 **/
					function showOkCheckoutMessage(sBackOrderMessage)
					{
					
						ajaxAddToCart();			

						sOrigText = $('#detailloadingpic').html();
						HideLoadingMessage(sOrigText);

						$("#dialog-box").html(sBackOrderMessage)
						$("#dialog-box").dialog();
						//getter
						var buttons = $("#dialog-box").dialog( "option", "buttons" );
						//setter
						$("#dialog-box").dialog( "option", "buttons", [
							{
								text: "Ok",
								click: function() { closeCartLightbox(); funcShowHideButtons(); $(this).dialog("close"); }
							},
							{
								text: "Checkout",
								click: function() { fncCheckout(); $(this).dialog("close"); }
							}
							
						] );	
					}

				})(jQuery);						
			
			});
		} //-if (bShowBackOrderMessage)

		function HideLoadingMessage(sOrigText){
			document.getElementById('detailloadingbg').style.display = 'none';
			document.getElementById('detailloadingpic').style.display = 'none';
			$('#detailloadingpic').html(sOrigText);
			fncEnableDroplistForm();
		}
		/**
		 * Close cart Lightbox and refresh the shopping cart window
		 *
		 * @author reece
		 * @author dand
		 * @since 1/27/2011
		 */
		function closeCartLightbox() {
					
			/*
			 * cart_window
			 */
			if (jQuery('#cart_window').length > 0){
				jQuery.ajax({ 
							url: "i_i_shopping_cart_window.asp"
							, cache: false
							, dataType: "html"
							, success: function(sResponse){ 
								jQuery('#cart_window').replaceWith(sResponse);
								jQuery("#atc_msg_buttons").show(); 
							}
						}); 
			}
			
			/*
			 * Close lightbox
			 */
			jQuery('#atc_msg')
				.fadeOut('fast', function(){
					jQuery('#atc_msg_container').hide();
					jQuery('#atc_msg_product').html('');
				});
		}//function closeCartLightbox

		
		/**
		 * Determines how the products should be posted (form or ajax)
		 *
		 * @author reece
		 * @author dand
		 * @since 1/27/2011
		 */
		function postToCart(){
			try {
				var aKeys = document.getElementsByName("keys");		

				for (var iKey = 0; iKey < aKeys.length; iKey++){
					try {
						var iQty = parseInt(document.getElementById('qty_' + aKeys[iKey].value).value);

						try {
							var iMinQty = parseInt(document.getElementById('min_order_qty_' + aKeys[iKey].value).value);
							if (!isNaN(iMinQty)){
								if (iQty<iMinQty){
									document.getElementById('qty_' + aKeys[iKey].value).value = iMinQty;
								}
							}
						} catch (err){
							//alert(err.message);
						}

						try {
							var iMaxQty = parseInt(document.getElementById('max_order_qty_' + aKeys[iKey].value).value);
							if (!isNaN(iMaxQty)){
								if (iQty>iMaxQty){
									document.getElementById('qty_' + aKeys[iKey].value).value = iMaxQty;
								}
							}
						} catch (err){
							//alert(err.message);
						}
					} catch (err){
						//alert(err.message);
					}
				}
			} catch (err){
				//alert(err.message);
			}
			
			
			var bAjax = false;
			
			//Validate Cart Options
			if ( bShowCartOpts ) {
				if( ! validateCartOptions() )
					return false;
			}
			
			/*
			 * Validate for config options to select
			 * @auther - vinayakj
			 * @since - 4/24/2012
			 */
			if ( bShowProdConfig ) {
				if (! validateConfigOptions() ) 
					return false;
			}
			
			/*
			 * Validate for Product Warehouse Selection
			 * @auther - vinayakj
			 * @since - 6/25/2012
			 */
			if (bShowPWSelection) {
				if (jQuery('#pw_id_'+sPKey).length > 0) {
					if (jQuery('#pw_id_'+sPKey).val() == '') {
							alert("Please select a Product Warehouse.");
							return false;
						}
				}
			}


			//If not ajax posting, return true to run the form action/post
			if( ! bAjax ) {
				return true;
			} //- if( ! bAjax )
			
			try {
							
				/*
				 * Show Cart Modal
				 */
				jQuery('#atc_msg').show();
				jQuery('#atc_msg_container').show();
				
				/*
				 * This is currently only set up to display a standalone product! 
				 * Child products or cart options will not be displayed.
				 */
				$prodnm = jQuery('#detail_parent_prod_nm').html();
				$prodqty = jQuery('#qty_box').val();
				$product = '<span class="thumb"></span><span class="nm"><strong>' + $prodnm + '</strong> (' + $prodqty + ')</span>';
				jQuery('#atc_msg_product').html($product);
				jQuery('#prodpicthumb').clone().appendTo('#atc_msg_product .thumb');
				
				/*
				 * Ajax add to cart
				 * @author dand
				 */
				$CartForm = jQuery('#frmAddToCart');					
				
				//Make ajax request relative to current domain
				sPostUrl = $CartForm.attr('action');
				sPostUrl = sPostUrl.substring(sPostUrl.indexOf('add_to_cart.asp'));

				jQuery.ajax({ 
					url: sPostUrl + "&action=ajax"
					, data: $CartForm.serialize()
					, cache: false
					, async: false
					, type: "POST"
					, dataType: "text"
					, success: function(){ 
						
						jQuery("#atc_msg_buttons").show(); 
					}
					,error: function(XMLHttpRequest, textStatus, errorThrown){
						addToCartError(errorThrown);
					}
				});
			
			} catch(errorThrown) {
				addToCartError(errorThrown);
			}
			
			/*
			 * Return false to prevent form action/post event
			 */
			return false; 

		}//function postToCart

		/**
		 * Validate the cart options
		 * 
		 * Requires all configured cart options to be populated
		 *
		 * @author dand
		 * @since 4/5/2011
		 */
		function validateCartOptions(){
			
			jQuery('#cart_opt_req').hide();
			
			jQuery('#cart_option_rows').children().each(function() {

				id		= jQuery(this).attr('id');
				pkey	= jQuery('#keys_' + id).val();
				qty		= jQuery('#qty_' + id).val();

				//Bail if no pkey or qty
				if ( pkey == '' || qty == '' )
					return;

				aCartOpts = sCartOptions.split("|");

				for (var iCartOptCounter = 0, iCartOptGoTo = aCartOpts.length; iCartOptCounter <= iCartOptGoTo; iCartOptCounter++) {
					sCartOpt	= jQuery('#cart_opt_' + iCartOptCounter + '_' + id).val();
					bCartOptRqd = jQuery('#rqd_cart_opt_' + iCartOptCounter + '_' + id).val();

					if ( sCartOpt == '' && bCartOptRqd == '1' ) {
						jQuery('#cart_opt_req').show();
					}
				}
			});

			return ! jQuery('#cart_opt_req').is(':visible');	
		}

		/*
		 * Validate for product options to be selected
		 * @auther - vinayakj
		 * @since - 4/21/2012
		 */
		function validateConfigOptions() {
			
			if (jQuery('#show_config_sections').val()!=0) {

				var sPKey = jQuery("#config_keys").val();
				var Sections = document.getElementsByName(sPKey + '_' + 'sections');
				var sSections= '';
				var sChoice = '';

				for (var i = 0; i < Sections.length; i++) {

					sChoice = jQuery('#' +sPKey + '_'+ Sections[i].value).val();

					if (sChoice == '') {
						alert("Please choose an item from each option.");
						return false;
					}
				}
			}
			return true;
		}

		function ajaxAddToCart()
		{
			
			//$('#detailloadingpic').html("Processing your request. Please wait...");
			if (sChildDisplay == "input-qty")
			{
				var keys = document.getElementsByName('keys');
				var pkey = "";
				var qty = "";
				
				 ajax_count = keys.length
				for(iKey=0;iKey<keys.length;iKey++)
				{
					p_key = keys[iKey].value
					qtybox = document.getElementById('qty_'+p_key);
					inputqty = qtybox.value;
					if (inputqty != "")
					{
					  pkey = p_key;
					  qty = inputqty;
					  MakeAJAXRequest(function(){ajax_count--;}, 'i_i_add_to_cart.asp?type=ajaxadd&key=' + pkey + '&qty=' + qty , true, [], [], true, 'There was an error adding your selection to the cart.', null, null)
					}
				}
				
			}
			else
			{
				pkey = jQuery("#keys").val();
				qty = jQuery("#qty_box").val();
				 MakeAJAXRequest(function(){ajax_count--;}, 'i_i_add_to_cart.asp?type=ajaxadd&key=' + pkey + '&qty=' + qty , true, [], [], true, 'There was an error adding your selection to the cart.', null, null)
			}
		}


		/**
		 * Handle Errors on the Ajax Add to Cart
		 */
		function addToCartError(errorThrown){
			alert('Failed to add selection to cart. ' + errorThrown.mesage);
			
			jQuery('#atc_msg')
				.fadeOut('fast', function(){
					jQuery('#atc_msg_container').hide();
					jQuery('#atc_msg_product').html('');
				});

			return false;
		}//function addToCartError

		// compares qty input to caseqty hidden input before adding to cart
		// used in catalog view
		function checkCaseQty(pkey) {
			var keys = document.getElementsByName('keys');
			var caseQty = Number(jQuery('#case_qty_' + pkey).val());
			var qty = Number(jQuery('#qty_' + pkey).val());

			if (caseQty !== 0) {
				// If child case quantity is disabled, use the parent product qty
				if (!bUseChildCaseQty) {
					caseQty = 0
				}

				if (qty % caseQty !== 0) {
					alert(''.replace('<qty>', caseQty));
					return false;
				}
			}

			return true;
		}

		function checkCaseQtys ( bPost ) {
			if (bUseCaseQty) {
				var bHitOne		= false;
				var keys		= document.getElementsByName('keys');
				var caseSize, qty;

				for (var i = 0; i < keys.length; i++) {

					caseSize = parseInt(jQuery('#case_qty_' + keys[i].value).val());
					
					if (caseSize > 1) {

						if ( jQuery('#qty_box').length > 0 ) {
							qty = jQuery('#qty_box');
						} else {
							qty = jQuery('#qty_' + keys[i].value);
						}

						if ( qty.val() != '' ) {
							if (parseInt(qty.val()) % caseSize != 0) {
								bHitOne = true;
							}
						}
					}
				}

				// bpost will be false if this is used in conjunction with other validation			
				if ( bPost ) {
					if ( bHitOne ) {
						alert("");
						return false;
					} else {
						return postToCart();
					}
				} else {
					if ( bHitOne ) {
						alert("");
						return false;
					} else {
						return true;
					}
				}
			}
		} //- function checkCaseQtys ( bPost )

		function fncRemoveSavedCookie(){
			try
			{	 
				oAjax.Reset();	
				oAjax.SetVar("winaction", "unsave");	
				oAjax.RequestFile	= "i_i_pc_style_search_form.asp"
				oAjax.Method		= "GET";
				oAjax.onCompletion	= function(){document.getElementById('detail_saved_selection').style.display='none';};
				oAjax.ResponseType	= "json"; //- The format of returned data. xml, text, json.
				oAjax.RunAJAX();

			}
			catch (err)
			{
				alert(err.mesage);
			}
		}//function fncRemoveSavedCookie()

		function GetXmlHttpObject() {
			// Create an XMLHttpRequest object
			var xmlHttp = null;
			try {
				// Firefox, Opera 8.0+, Safari
				xmlHttp = new XMLHttpRequest();
			} catch (e) {
				// Internet Explorer
				try {
					xmlHttp = new ActiveXObject("Msxml2.XMLHTTP");
				} catch (e) {
					xmlHttp = new ActiveXObject("Microsoft.XMLHTTP");
				}
			}
			return xmlHttp;
		}

		function dec2hex(dec) {
			// Generate 32 character hex ID
			//--------------------------------------------------------
			// Decimal to hex
			var hD="0123456789ABCDEF";
			var hex = hD.substr(dec&15,1);
			while (dec>15) {
				dec >>= 4;
				hhex = hD.substr(dec&15,1) + hex;
			}
			return hex;
		}

		// Hex to decimal
		function hex2ddec(hex) {
			return parseInt(hex,16);
		}

		function genID() {
			var id = "";
			var i;
			for (i = 0; i < 32; i++) {
				id = id + dec2hex(Math.round(16*Math.random()));
			}
			return id;
		}

		var oProdHTTP;

		// Create an XMLHttpRequest object
		function GetXmlProdHttpObject() {
			try {
				// Firefox, Opera 8.0+, Safari
				oProdHTTP = new XMLHttpRequest();
			} catch (e) {
				// Internet Explorer
				try {
					oProdHTTP = new ActiveXObject("Msxml2.XMLHTTP");
				} catch (e) {
					oProdHTTP = new ActiveXObject("Microsoft.XMLHTTP");
				}
			}
			//return xmlHttp;
		}


		function openWindow(strPage, strKey){
			window.open(strPage + "?url=https%3A%2F%2Fwinning%2Dmoves%2Ecom&pagename=&p_key=79CA3421E53B4167AABDE2C1136CA5DA&link=/pc_product_detail.asp&img=" + strKey,"" ,"toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=no,copyhistory=yes,width=400,height=450")
		}

		function openNewWindow(strPageName){
			window.open(strPageName,"Action","scrollbars=yes,resizable=yes,height=350,width=600,screenX=150,screenY=50,top=50,left=150,toolbar=yes,directories=no,menubar=yes");
		}

		function GetChildInfo(){
			aChildInfo = document.getElementById('child_info').value.split('|');

			var sHiddenPKey = '<input type="hidden" name="keys" value="' + aChildInfo[0] + '" />';
			//var sHiddenQty = '<input type="hidden" name="qty_' + aChildInfo[0] + '" value="1" />';
			var sInputQty = '<input name="qty_' + aChildInfo[0] + '" id="qty_' + aChildInfo[0] + '" class="qtyinput" type="text" value="1" onclick="this.focus();this.select();" />';
			var sHiddenPrice = '<input type="hidden" name="price_' + aChildInfo[0] + '" value="' + aChildInfo[1] + '" />';

			document.getElementById('child_atc_opts').innerHTML = sHiddenPKey + sHiddenPrice;
			document.getElementById('child_qty').innerHTML = sInputQty;
			if(document.getElementById('child_cart_section')) 
				document.getElementById('child_cart_section').style.display = 'block';

		}

		function fncDisableDroplistForm(){
					
			try{
				if(document.getElementById('submit_button'))
					document.getElementById('submit_button').disabled = true;

				document.getElementById('prod_opt1').disabled = true;
				document.getElementById('prod_opt2').disabled = true;
				document.getElementById('prod_opt3').disabled = true;
				document.getElementById('prod_opt4').disabled = true;
				document.getElementById('prod_opt5').disabled = true;
				document.getElementById('prod_opt6').disabled = true;
			} catch (err){
				//alert(err.message);
			}
		}

		function fncEnableDroplistForm(){
			
			try{
				if(document.getElementById('submit_button'))
					document.getElementById('submit_button').disabled = false;
					
				document.getElementById('prod_opt1').disabled = false;
				document.getElementById('prod_opt2').disabled = false;
				document.getElementById('prod_opt3').disabled = false;
				document.getElementById('prod_opt4').disabled = false;
				document.getElementById('prod_opt5').disabled = false;
				document.getElementById('prod_opt6').disabled = false;
			} catch (err){
				//alert(err.message);
			}
		}

		function fncColorSizes(vDroplist){
			var vOpt = 3;
			var vKeepGoing = false
			var vLast = 3;

			if (vDroplist){
				if (document.getElementById('prod_opt1').value.replace(/\s+/, "")!=''){
					oAjax.Reset();
					oAjax.SetVar('detailpageaction', 'ajaxcall');
					oAjax.SetVar('actiontype', 'getcolorsizes');
					oAjax.SetVar('key', '79CA3421E53B4167AABDE2C1136CA5DA');
					oAjax.SetVar('parent_atc', '0');
					oAjax.SetVar('parent_price', '0');
					oAjax.SetVar('use_child_pics', 'False');
					oAjax.SetVar('use_child_docs', 'False');
					oAjax.SetVar('use_child_ds', 'False');
					oAjax.SetVar('parent_config_sections','');

					sVal = document.getElementById('prod_opt1').value;
					sVal = sVal.replace("%2D","-");
					oAjax.SetVar('color', escape(sVal));

					oAjax.EncodeURIString	= false; //- cain 3/18/2010 The escape was "double encoding" the %.
					oAjax.RequestFile	= "/pc_product_detail.asp";
					oAjax.Method		= "GET";
					oAjax.ResponseType	= "json";
					oAjax.onLoading		= ResizeLoadingBG;
					oAjax.onCompletion	= fncDrawSizes;
					oAjax.RunAJAX();
				}
			} else {
				if (document.getElementById('color').value.replace(/\s+/, "")!=''){				
					oAjax.Reset();
					oAjax.SetVar('detailpageaction', 'ajaxcall');
					oAjax.SetVar('actiontype', 'getcolorsizes');
					oAjax.SetVar('key', '79CA3421E53B4167AABDE2C1136CA5DA');
					oAjax.SetVar('parent_atc', '0');
					oAjax.SetVar('parent_price', '0');
					oAjax.SetVar('use_child_pics', 'False');
					oAjax.SetVar('use_child_docs', 'False');
					oAjax.SetVar('color', escape(document.getElementById('color').value));
					oAjax.SetVar('use_child_ds', 'False');
					oAjax.SetVar('parent_config_sections','');

					oAjax.EncodeURIString	= false; //- cain 3/18/2010 The escape was "double encoding" the %.
					oAjax.RequestFile	= "/pc_product_detail.asp";
					oAjax.Method		= "GET";
					oAjax.ResponseType	= "json";
					oAjax.onLoading		= ResizeLoadingBG;
					oAjax.onCompletion	= fncDrawColorSizes;
					oAjax.RunAJAX();
				}
			}
		

		} // function fncColorSizes(vDroplist)
		// EVENT FUNCTIONS ==================================================
		function fncDrawSizes() {
			var aUsedValues		= new Array();
			window.oChildProds	= oAjax.Response;

			document.getElementById('prod_opt2').disabled = false;

			try{				
				/*
				 * removes all previous options
				 */
				var oOptSelect = document.getElementById('prod_opt2');
				oOptSelect.options.length = 0;

				try {

					for ( strPKey in window.oChildProds ) {

						oProdInfo = window.oChildProds[strPKey];
						
						if ( ! InArray(aUsedValues, oProdInfo.size) ) {
							oOptSelect.options[oOptSelect.options.length] = new Option(oProdInfo.size, strPKey);
							aUsedValues[aUsedValues.length] = oProdInfo.size;
						} //- if ( ! InArray(aUsedValues, oProdInfo.size) )

					} //- for ( strPKey in window.oChildProds )

				} catch ( oError ){
					alert(oError.message);
					HideLoading();
				}
				
				if ( oOptSelect.options.length < 1 ) {
					oOptSelect.options[oOptSelect.options.length] = new Option('No Sub-Options Found', '');
					oOptSelect.disabled = true;
				} else {
					oOptSelect.disabled = false;
				} //- if ( oOptSelect.options.length < 1 )
				
			} catch ( oError ) {
				alert(oError.message);
			}

			fncProcessSizeProduct();
			HideLoading();

		} //- function fncDrawSizes()

		function fncDrawColorSizes() {
			var aUsedValues		= new Array();
			window.oChildProds	= oAjax.Response;
			
			try {
				var strSizeOutput 	= '';
				var strInputsOutput = '';
				var strTemp 		= '';
				var strDisabled 	= '';
				var strPic 			= '';
				var iColCount 		= 0;
				var iTotalCol 		= parseInt('');
				var bEnforceIpBlock = false;
				var sIpBlockType 	= '';
				var bShowAtc 		= true;

				if ( bEnforceIpBlock && sIpBlockType == 'ordering' ) {
					bShowAtc = false;
				} //- if ( bEnforceIpBlock && sIpBlockType == 'ordering' )

	//				oSizes = xmlDoc.getElementsByTagName("record");
	//				strPic = getNodeValue(xmlDoc, 'color_img', 0)

				sHeadRow = '<tr class="headrow">';

				try {

					iSize = 0;

					for ( strPKey in window.oChildProds ) {

						oProdInfo = window.oChildProds[strPKey];
						
						if ( ! InArray(aUsedValues, oProdInfo.size) ){
							sHeadRow = sHeadRow + '<td align="center" valign="top"><input type="hidden" name="keys" value="' + strPKey + '" />' + oProdInfo.size + '</td>';
							aUsedValues[aUsedValues.length] = oProdInfo.size;
							iSize++;
						} //- if( ! InArray(aUsedValues, oProdInfo.opt) )

					} //- for ( strPKey in window.oChildProds )

				} catch ( oError ) {
					alert(oError.message);
					//HideLoading();
				}

				sHeadRow = sHeadRow + '</tr>';
				
				try {

					for ( strPKey in window.oChildProds ) {

						oProdInfo = window.oChildProds[strPKey];

						iColCount++;
						strDisabled = '';

						if ( ! oProdInfo.showCart ) {
							strDisabled = ' disabled';
						}

						if ( oProdInfo.showPrice != 'True' ) {
							cPrice = '&nbsp;';
						} else {
							cPrice = oProdInfo.price;
						}
						
						if ( oProdInfo.showInventory != 'True' ) {
							sInvMsg = '&nbsp;';
						}

						strTemp = strInputsOutput + '<td align="center" valign="top"><div class="asc-matrix-price">' + oProdInfo.price + '</div>';
						strInputsOutput = strTemp;

						if ( ! oProdInfo.showCart ) {
							strTemp = strInputsOutput + '-';
						} else {
							strTemp = strInputsOutput + '<input type="text" name="qty_' + strPKey + '" id="qty_' + strPKey + '" value="" size="3" onclick="this.focus();this.select();" onkeypress="return NumbersOnly(this, event);" maxlength="9" class="qtybox"' + strDisabled + ' />';

							// Build hidden input for case sizes
							var caseSize = 0;
							if (bUseCaseQty) {
								if (bUseChildCaseQty) {
									caseSize = oProdInfo.case_qty;
								} else {
									caseSize = 0;
								}

								strTemp += '<input type="hidden" id="case_qty_' + strPKey + '"value="' + caseSize + '" />';
							}
						}

						strInputsOutput = strTemp;

						strTemp = strInputsOutput + '<div class="asc-matrix-idp">' + oProdInfo.invMsg;

						

						strInputsOutput = strTemp;

						
							strTemp = strInputsOutput + '<em>' + oProdInfo.sku + '</em>'
						

						// Show case quantity text
						if (bUseCaseQty && bUseChildCaseQty && oProdInfo.case_qty > 0) {
							strTemp += "<p style='font-weight:bold'>Available in cases of <qty></p>".replace("<qty>", oProdInfo.case_qty);
						}
						
						strInputsOutput = strTemp + '</div></td>';

						if ( iColCount == iTotalCol ) {
							strTemp = strInputsOutput + '</tr><tr>';
							strInputsOutput = strTemp;
							iColCount = 0;
						} //- if ( iColCount == iTotalCol )
						
						
					} //- for ( strPKey in window.oChildProds )

				} catch ( oError ) {
					alert(oError.message);
				}

				var caseQtyText = '';
				if (bUseCaseQty && !bUseChildCaseQty) {
					caseQtyText = '<p style="font-size:1.1em;font-weight:bold;color:black;">' + "Available in cases of 0" + '</p>';
				}
				
				sAtcHtml = '<h2>Available Sizes</h2>' + caseQtyText + '<table class="asc-matrix" cellspacing="0" border="0">' + sHeadRow + strInputsOutput + '</table><div class="add_cart_container">';

				if ( bUseProductAliases ) {

					if ( jQuery.trim(oProdInfo.pa_key) != '' ) {
						sAtcHtml += '<input type="hidden" id="pa_id_' + oProdInfo.p_key + '" name="pa_id_' + oProdInfo.p_key + '" value="' + oProdInfo.pa_key + '" />';
					} //- if jQuery.trim(oProdInfo.pa_key) != '' )

				} //- if ( bUseProductAliases )

				if ( bShowAtc ) {
					sAtcHtml += '<input type="submit" value="Add to Cart" class="btn_addtocart chrome" />';
				} //- if ( bShowAtc )

				sAtcHtml += '</div>';
				
				jQuery('#detail_mx1_sizeinfo').html(sAtcHtml);
				
			} catch ( oError ) {
				alert(oError.message);
				document.getElementById('detail_mx1_sizeinfo').innerHTML = 'Error loading sizes found in this color!';
				HideLoading()
			}

			HideLoading();

		} //- function fncDrawColorSizes()

		/**
		 * Update Qty for "Select List" Addon Products
		 */
		function fncUpdateAddonsSelectQty(oSelect){
			sPKey = jQuery(oSelect).val();
			jQuery('#addon_qty_container').html('<input type="hidden" value="1" name="qty_' + sPKey + '"/>');
		}//-function fncUpdateAddons
		
		
		/**
		 * Ajax to process parent-child product nested drop list displays
		 *
		 * @author dand
		 * @internal refactored on 4/8/2010 - dand
		 *
		 * @param int vOpt			int of the option to processed (1-4)
		 * @param bool vKeepGoing	determines if function should recurse
		 * @param int vLast			the total number of nested drop lists (1-4)
		 */
		function fncGetOptDroplist ( vOpt, vKeepGoing, vLast ) {
			var oAjaxData = { 
				'opts': vOpt 
				, 'detailpageaction': 'ajaxcall'
				, 'actiontype': 'getnestedopts'
				, 'key': '79CA3421E53B4167AABDE2C1136CA5DA'
				, 'parent_atc': '0'
				, 'parent_price': '0'
				, 'use_child_pics': 'false'	
				, 'use_child_docs': 'false'
				, 'use_child_cart_opts': 'false'
				, 'use_child_ds': 'false'
				, 'parent_config_sections':''
			};

			switch ( vOpt ) {
				/*
				 *Add mode case condition for 5 & 6 Droplist
				 *@author pijushb
				 *since 5/17/2012
				 **/
				case 6:
					var sOpt5Key = jQuery('#prod_opt5').val();
					var oOpt5Info = window.oChildProds[sOpt5Key];
					var sVal = escapeUriQueryParens(jQuery("#prod_opt5 option[value='" + sOpt5Key + "']").text());
					oAjaxData.opt5 = sVal;
				case 5:
					var sOpt4Key = jQuery('#prod_opt4').val();
					var oOpt4Info = window.oChildProds[sOpt4Key];
					var sVal = escapeUriQueryParens(jQuery("#prod_opt4 option[value='" + sOpt4Key + "']").text());
					oAjaxData.opt4 = sVal;
				case 4:
					var sOpt3Key = jQuery('#prod_opt3').val();
					var oOpt3Info = window.oChildProds[sOpt3Key];
					var sVal = escapeUriQueryParens(jQuery("#prod_opt3 option[value='" + sOpt3Key + "']").text());
					oAjaxData.opt3 = sVal;
					//Drop Through
				
				case 3:
					var sOpt2Key = jQuery('#prod_opt2').val();
					var oOpt2Info = window.oChildProds[sOpt2Key];
					var sVal = escapeUriQueryParens(jQuery("#prod_opt2 option[value='" + sOpt2Key + "']").text());
					oAjaxData.opt2 = sVal;
					//Drop Through
				
				case 2:
					var sVal = escapeUriQueryParens(jQuery('#prod_opt1').val());
					oAjaxData.opt1 = sVal;
					break;

				default:
					break;
			}//- switch ( vOpt )

			jQuery.ajax({ 
				url: "/pc_product_detail.asp"
				, data: oAjaxData
				, cache: false
				, type: "GET"
				, dataType: "json"
				, beforeSend: function() { ResizeLoadingBG(); }
				, success: function(oData){ fncDrawOptDroplist( oData, vOpt, vKeepGoing, vLast ) }
			});
			
		} //- function fncGetOptDroplist ( vOpt, vKeepGoing, vLast )

		// EVENT FUNCTIONS ==================================================
			function fncDrawOptDroplist ( oData, vOpt, bKeepGoing, vLast ) {

				var iOpt			= parseInt(vOpt);
				var iLastOpt		= parseInt(vLast);
				var aUsedValues		= new Array();

				window.oChildProds	= oData;

				if ( document.getElementById('prod_opt' + (iOpt - 1)) ){
					document.getElementById('prod_opt' + (iOpt - 1)).disabled = false;
				}

				if ( bKeepGoing ) {
					bKeepGoing = true;
				} else {
					bKeepGoing = false;
				}

				if ( iLastOpt == iOpt ) {
					bKeepGoing = false;
				}

				try {

					/*
					 * removes all previous options
					 */
					var oOptSelect = document.getElementById('prod_opt' + iOpt);
					oOptSelect.options.length = 0;

					try {
						for ( strPKey in window.oChildProds ) {
							
							oProdInfo = window.oChildProds[strPKey];
							
							if ( ! InArray( aUsedValues, oProdInfo.opt ) ){
								oOptSelect.options[oOptSelect.options.length] = new Option(oProdInfo.opt , strPKey);
								aUsedValues[aUsedValues.length] = oProdInfo.opt;
							} //-if( ! InArray(aUsedValues, oProdInfo.opt) )
						
						} //-for(key in oChildProds)

						/*
						 * Recursivly Call fncGetOptDroplist until
						 * we're done getting all the drop lists
						 */
						if ( bKeepGoing ) {

							if ( iOpt == 5 ) {
								fncGetOptDroplist( iOpt + 1, false, iLastOpt );
							} else {
								fncGetOptDroplist( iOpt + 1, true, iLastOpt );
							}

						} else {

							fncProcessOptProduct( iOpt );
							HideLoading();

						} //- if ( bKeepGoing )				

					} catch ( err ){
						alert(err.message);
						HideLoading();
					}
					
					if ( oOptSelect.options.length < 1 ) {
						oOptSelect.options[oOptSelect.options.length] = new Option('No Sub-Options Found', '');
						oOptSelect.disabled = true;
					} else {
						oOptSelect.disabled = false;
					}
				
				} catch (err){
					alert(err.message);
				}
		
				/*
				 * Add Code to show/hide review message and buttons.
				 * @author pijushb
				 * @since 1/24/2012
				 **/
				 if (bShowBackOrderMessage)
				 {
					sPrevSku = jQuery("#previous_sku").val();
					bReviewMessage = $("#review_message_"+sPrevSku).is(":visible")

					if (bReviewMessage)
					{
						$("#review_message_"+sPrevSku).hide();
					}
					
					bSubmitButton = $("#submit_button").is(":visible")

					if (!bSubmitButton)
					{
						 $("#submit_button").show();
						 $("#check_stock_button").show();
						 $("#checkout_button").hide();
					}

				 }
				 
			} //- function fncDrawOptDroplist
		//================================================================

		/**
		 * SearchString escape the parens in the uri query
		 *
		 * @param string sVal	string containing the value to escape
		 * @return string	string with properly escaped parens for searchstring
		 */
		function escapeUriQueryParens(sVal){
			if(typeof sVal == 'undefined'){
				return;
			}

			sValue = sVal;

			sValue = sValue.replace(/%28/gi,"\(");
			sValue = sValue.replace(/%29/gi,"\)");
			sValue = sValue.replace(/\(/gi,"\\(");
			sValue = sValue.replace(/\)/gi,"\\)");

			return sValue;
		}

		function fncProcessOptProduct ( vOpt ) {
			
			try {
				var sPKey 		= jQuery('#prod_opt' + vOpt).val();
				var oProdInfo 	= window.oChildProds[sPKey];

				//Global scope the pkey
				window.sChildPkey = sPKey;

				/*
				 * Bail if no key or no product data
				 */
				if ( sPKey == '' || typeof oProdInfo == "undefined" ) {
					hideProductContainer();
					return false;
				} //- if ( sPKey == '' )
				
				if ( jQuery('#qty_box').length > 0 )
					jQuery('#qty_box').attr('name', 'qty_' + sPKey);
				
				jQuery('#keys').val(sPKey);
				
				/*
				 * Update SKU
				 */
				jQuery('#sku_container').html('SKU: ' + oProdInfo.sku);
				
				/*
				 * Cart
				 */
				if ( oProdInfo.showCart ) {
					
					if ( jQuery('#child_cart_section').length > 0 )
						jQuery('#child_cart_section').show();
					
					/*
					 * Handle Cart Options defined on Child Product
					 */
					if ( bUseChildCartOpts ) {

						if ( oProdInfo.cartOptions != '' && jQuery('#pc_cart_options_' + vOpt).length > 0 ) {
							buildCartOption(sPKey, oProdInfo.cartOptions, vOpt);
						} else {
							jQuery('#pc_cart_options_' + vOpt).html('');
						}

					} //- if ( bUseChildCartOpts )
					
					

					/*
					 * Cart Options defined on Parent (standard config)
					 * need to know if this is the "last" droplist being displayed...
					 */
					if ( jQuery('#pc_cart_options_' + vOpt).length > 0 ) {

						jQuery('#pc_cart_options_' + vOpt).slideDown();
						// change the name of the hidden input so it will post to the item in the cart
						jQuery('#cart_option_79CA3421E53B4167AABDE2C1136CA5DA').attr("name","cart_option_" + sPKey);

					} //- if ( jQuery('#pc_cart_options_' + vOpt).length > 0 )
						
				} else {

					hideChildProductInputs();

				} //-if(oProdInfo.showCart)
				
				/*
				 * Product Unit Display
				 */
				if ( 'productUnit' in oProdInfo ) {
					if(oProdInfo.productUnit != '')
						jQuery('#product_unit_container').html('Unit: ' + oProdInfo.productUnit);
				} //- if ( 'productUnit' in oProdInfo )
				
				/*
				 * Single Unit of Measure (products.unit)
				 */
				if ( 'uomHTML' in oProdInfo ) {

					if ( oProdInfo.uomHTML != '' ) {
						jQuery('#detail_atc_standalone').html(oProdInfo.uomHTML);
						jQuery('#child_cart_section').html(oProdInfo.uomHTML);
					}

				} //- if ( 'uomHTML' in oProdInfo )
				
				/*
				 * Parent Addon Products
				 */
				if ( bShowParentAddonProds ) {
					jQuery('#addon_product_container').slideDown();
					jQuery('#addon_products').attr('name','keys');
				} else {
					jQuery('#addon_product_container').slideUp();
					jQuery('#addon_products').attr('name','keys_no_post');
				} //- if ( bShowParentAddonProds )

				/*
				 * Child Addon Products
				 */
				if ( bShowChildAddonProds && 'showChildAddonProds' in oProdInfo ) {

					if ( ! oProdInfo.showChildAddonProds ) {
						jQuery('#addon_product_container').slideUp();
						jQuery('#addon_products').attr('name','keys_no_post');
					} else {
						jQuery('#addon_product_container').slideDown();
						jQuery('#addon_products').attr('name','keys');
					} //- if ( ! oProdInfo.showChildAddonProds )

				} //- if ( 'showChildAddonProds' in oProdInfo )
				
				
				/*
				 * Price
				 */
				 
				/*
				 * Check for Price Display type
				 * @author	pijushb
				 * @since	4/25/2011
				 */
				var bShowRegPrice	= true;
				var bShowATCQty		= false;
				var sShowMessage 	= '';

				if ( sShowPriceDisplayTypeDropList ) {

					switch ( sPriceDisplayType ) {

						case 'hide':
							bShowRegPrice	= false;
							bShowATCQty		= true;
							sShowMessage	= '-';
							break;

						case 'show_message':
							bShowRegPrice	= false;
							bShowATCQty		= true;
							sShowMessage	= sPriceMessage;
							break;

						case 'require_atc':
							bShowRegPrice	= false;
							bShowATCQty		= true;
							sShowMessage	= sHelpText;
							break;

						case 'require_login_or_atc':
							
								bShowRegPrice	= false;
								bShowATCQty		= true;
								sShowMessage	= sHelpText
														
							break;
						
						case 'require_login_for_price_and_atc':
							
								bShowRegPrice	= false;
								sShowMessage	= sHelpTextLogin
							
							break;

						default: 
							bShowRegPrice = true;
							break;

					} //- switch ( sPriceDisplayType )

				} // if ( sShowPriceDisplayTypeDropList )
						
				if ( bShowRegPrice ) {

					//Display standard
				
				} else {

					oProdInfo.showPrice=false;
					jQuery('#price_display_type_message').html('<div class="detail_desc_content">' + sShowMessage + '</div>');

					if ( ! bShowATCQty ) {
						jQuery('#child_cart_section').hide();
					} //- if ( ! bShowATCQty )

				} //- if ( bShowRegPrice )

				/*
				 * Set Dangerous Price Ratio
				 * @author	vinayakj
				 * @since	4/25/2011
				 */
				if ( bShowHazmatRatio ) {

					if ( oProdInfo.dangerous_price_ratio > 0 ) {
						jQuery('#dangerous_price_ratio').show();
						jQuery('#dangerous_price_ratio_value').html(oProdInfo.dangerous_price_ratio);
					} else {
						 jQuery('#dangerous_price_ratio').hide();
					} //- if ( oProdInfo.dangerous_price_ratio > 0 )

				} //- if ( bShowHazmatRatio )

				if ( oProdInfo.showPrice ) {

					/*
					 * Draw full UOM section (products.uom_std, products.uom_sales, 
					 * products.uom_sales_conversion and additional unit of measure 
					 * conversions from the unit_of_measure table)
					 */
					 
					sUomView = '';

					if ( bShowSalesUOM || bOnlyShowSalesUOM || bShowAdditionalSalesUOM ) {
						sUomView = fncDrawUOM ( sPKey, oProdInfo );
					}
					
					if ( sUomView != '' ) {
						jQuery('#child_cart_section').html( sUomView );
						jQuery('#child_cart_section').show();

					} else {

						if ( jQuery('#price_container').length > 0  ) {

							/*
							 * Add Qty Pricing Link for Child Product
							 */
							var sPriceBreakHTML = '';

							if ( bShowChildQtyPricing ) {

								if ( 'showPriceBreaks' in oProdInfo ) {
									sPriceBreakHTML = '<li id="qtypricing"></li>';
								} //- if ( 'showPriceBreaks' in oProdInfo )

							} //- if ( bShowChildQtyPricing )

							iRetailPrice	= parseFloat(oProdInfo.retail_price.replace('$','').replace(',',''));
							iPrice          = parseFloat(oProdInfo.price.replace('$','').replace(',',''));

							cRetailPrice	= oProdInfo.retail_price;
							cPrice 			= oProdInfo.price
							
							/*
							 * code to compare final price to retail price or suggested retail price
							 * depending on which values are populated and value are greater than
							 * the final price returned by the oRs.GetPrice call
							 *
							 * @author	johns
							 * @since	12/22/2011
							 */
							if ( bShowPriceCompare ) {

								if ( oProdInfo.listprice ) {
									iListPrice		= parseFloat(oProdInfo.listprice.replace('$','').replace(',',''));							
								} else {
									iListPrice = 0;
								} //- if ( oProdInfo.listprice )

								if ( iPrice >= iRetailPrice && iListPrice != '' ) {
									iRetailPrice = iListPrice;
									cRetailPrice = oProdInfo.listprice
								} //- if ( iRetailPrice <= iPrice && iListPrice != '' )

								if ( iPrice < iRetailPrice ) {
									iPercent		= (iRetailPrice - iPrice) / iRetailPrice; 
									iPercentSaved	= iPercent * 100;

									jQuery('#price_container').html('<ul class="detail_pricing"><li class="saleprice">' + cPrice + '</li>' + sPriceBreakHTML + '<li class="listprice">List Price: <span class="strike">' + cRetailPrice + '</span></li><li class="savings">You Save: ' + Math.round(iPercentSaved * 100) / 100 + '%</li></ul>');
								} else {
									jQuery('#price_container').html(oProdInfo.price);
								}
							} else {
								jQuery('#price_container').html('<ul class="detail_pricing"><li class="saleprice">' + FormatCurrency(oProdInfo.price, true) + '</li>' + sPriceBreakHTML + '</ul>');
							} //- if ( bShowPriceCompare )

						} //- if(jQuery('#price_container').length > 0)
					
					} //- if ( sUomView != '' )
					
					jQuery('#price_container').show();

				} else {

					jQuery('#price_container').hide();

				}//- if ( oProdInfo.showPrice )
				
				
				/*
				 * Add hidden field for qty available to check back order.
				 * @author	pijushb
				 * @since	9/28/2011
				 */
				if ( bShowBackOrderMessage ) {
					jQuery('.qtyavailable').remove();

					jQuery('#idp_container')
						.parent()
						.append('<div id=review_message_' + sPKey + ' style="display: none;"></div><input class="qtyavailable" type=hidden id=qty_available_' + sPKey + ' value=' + oProdInfo.qty_available + '>')
				} //- if ( bShowBackOrderMessage )

				/*
				 * Inventory
				 */
				if ( oProdInfo.showInventory ) {
					jQuery('#idp_container').html(oProdInfo.invMsg);

					/**
					 * if status = out then show "add product to watch list" link
					 *
					 * @author	johns
					 * @since	12/11/2009
					 */
					if ( bShowInvWatchLink ) {

						if ( oProdInfo.invStatus == 'out' ) {
							hideChildProductInputs();
							
							var selected_prod = document.getElementById('prod_opt'+ vOpt).selectedIndex;
							var selected_prod_nm = document.getElementById('prod_opt'+ vOpt).options[selected_prod].text;

							jQuery('#idp_container').append('<a class="thickbox" href="i_i_prod_inv_watch_add.asp?p_id=' + sPKey + '&p_nm=' + selected_prod_nm + '&p_sku=' + oProdInfo.sku + '&TB_iframe=true&height=400&width=400&modal=false" title="Add Product to Inventory Watch List" class="thickbox">Add Product to Inventory Watch List</a>');
						} //- if ( oProdInfo.invStatus == 'out' )
						
					} //- if ( bShowInvWatchLink )
					
				} //- if ( oProdInfo.showInventory )
				
				if(bShowInvByWarehouse)
				{
					jQuery.ajax({ 
							url: "?pageaction=inventorybywarehouse&key=" + sPKey
							, cache: false
							, dataType: "text"
							, success: function(sResponse){ 
								jQuery('#pw_table').html(sResponse);
							}
						});
				}
				
				/*
				 * Append Favorite link with Child Product Key
				 * @auther - vinayakj - 
				 * @since - 6/5/2012
				 */
				if (bShowFavoriteLink && bShowChildFavoriteLink && jQuery('#idp_container li[id="addfave"]').length === 0) {
					jQuery('#idp_container').append('<ul id="detail_links" class="clearfix"><li id="addfave"><a href="i_i_add_product_to_favorites.asp?p_id=' + sPKey +'&TB_iframe=true&height=400&width=400&modal=false" title="Add to Favorites" class="thickbox">Add to Favorites</a></li></ul>');

					tb_init('#idp_container a.thickbox, area.thickbox, input.thickbox');

				}

				/**
				 * Child Product Images
				 *
				 * @author	dand
				 * @since	4/6/2010
				 */
				if ( bUseChildPics ) {
				
					/**
					 * Main Image & View Larger Link
					 */
					if ( oProdInfo.pic && oProdInfo.pic != '' ) {						
						
						/*
						 * Clear Child Image & View Larger link
						 */
						/*
						if(jQuery(".child_prod_img_link").length > 0){
							jQuery(".child_prod_img_link").remove();
							jQuery("#child_detail_enlarge").remove();
						}
						*/

						/*
						 * Build Image & View Larger Link
						 */
						if ( oProdInfo.lg_pic != '' ) {
							
							/*jQuery("div.detail_photo")
								.prepend('<a class="child_prod_img_link" title="' + oProdInfo.name + '" href="images/' + oProdInfo.lg_pic + '" style="display:none;">' 
								+ '<img alt="' + oProdInfo.name + '" name="prodpic" src="images/' + oProdInfo.pic + '"><br/></a>'
								+ '<a id="child_detail_enlarge" title="' + oProdInfo.name + '" href="images/' + oProdInfo.lg_pic + '">View Larger</a>');*/
							
							jQuery('#detail_photo_container a.thickbox').attr('href', 'images/' + oProdInfo.lg_pic);
							jQuery('#detail_photo_container img#prodpicthumb').attr('src', 'images/' + oProdInfo.pic);
							
						} else {

							/*jQuery(".detail_photo").prepend('<span class="child_prod_img_link"><img alt="' + oProdInfo.name + '" name="prodpic" src="images/' + oProdInfo.pic + '"><br/></span>');*/
							jQuery('#detail_photo_container img#prodpicthumb').attr('src', 'images/' + oProdInfo.pic);

						} //- if ( oProdInfo.lg_pic != '' )

						/*
						 * Hide Parent & Show Child
						 */

						/*//parent images
						jQuery("#prodpicthumb").hide();
						jQuery("#detail_enlarge").hide();
						
						//no image
						jQuery(".detail_photo p:contains('sorry, no image')").hide();
						
						//child image
						jQuery(".child_prod_img_link").fadeIn( 1000 );*/

					} else {

						jQuery('#detail_photo_container a.thickbox').attr('href', sLargePic);
						jQuery('#detail_photo_container img#prodpicthumb').attr('src', sDetailPic);

						/*
						 * Hide Child Image & Show Parent Image
						 */
						/*//parent images
						jQuery("#prodpicthumb").fadeIn( 1000 );
						jQuery("#detail_enlarge").show();

						//no image
						jQuery(".detail_photo p:contains('sorry, no image')").show();
						
						//child image
						jQuery(".child_prod_img_link").hide();
						jQuery("#child_detail_enlarge").hide();*/

					} //- if ( oProdInfo.pic && oProdInfo.pic != '' )


					/*
					 * Additional Images
					 */
					if ( oProdInfo.additionalPics && oProdInfo.additionalPics.length > 0 ) {
						
						/*
						 * Clear Child Additional Images
						 */
						if ( jQuery('.detail_multipic ul.child_prods').length > 0 ) {
							jQuery('.detail_multipic ul.child_prods li').remove();
						} else {
							jQuery('.detail_multipic').append('<ul class="child_prods" style="display:none;"></ul>');
						} //- if ( jQuery('.detail_multipic ul.child_prods').length > 0 )

						/*
						 * Build Child Additional Images
						 */
						for ( var iCounter = 0, goTo = oProdInfo.additionalPics.length - 1; iCounter <= goTo; iCounter++ ) {
							oPics = oProdInfo.additionalPics[iCounter];

							jQuery('.detail_multipic ul.child_prods').append('<li><a title="' + oProdInfo.name + '" href="images/' + oPics.thumb + '"><img src="images/' + oPics.large + '"></a></li>');	
						} //- for ( var iCounter = 0, goTo = oProdInfo.additionalPics.length - 1; iCounter <= goTo; iCounter++ )
						
						/*
						 * Hide Parent Images & Show Child Images
						 */
						jQuery('.detail_multipic ul').not('.child_prods').hide();
						jQuery('.detail_multipic ul.child_prods').fadeIn( 1000 );
						//tb_init('a.thickbox, area.thickbox, input.thickbox');
						
					} else {

						/*
						 * Hide Child Images & Show Parent Images
						 */
						jQuery('.detail_multipic ul').not('.child_prods').fadeIn( 1000 );
						jQuery('.detail_multipic ul.child_prods').hide();
						//tb_init('a.thickbox, area.thickbox, input.thickbox');

					} //- if ( oProdInfo.additionalPics && oProdInfo.additionalPics.length > 0 )

				} //- if ( bUseChildPics ) 

				/*
				 * Child Product Documents
				 *
				 * @author	dand
				 * @since	4/6/2010
				 */
				if ( bUseChildDocs ) {

					if ( oProdInfo.documents.length > 0 ) {
						
						/*
						 * Clear Child Documents
						 */
						if ( jQuery("#child_doc_download").length > 0 ) {
							jQuery("#child_doc_download").html('<span>Downloads:</span>');
						} else {
							jQuery("#doc_download").parent().append('<li style="display:none;" id="child_doc_download"><span>Downloads:</span></li>');
						} //- if ( jQuery("#child_doc_download").length > 0 )
						
						/*
						 * Build Child Documents
						 */
						for ( var iCounter = 0, goTo = oProdInfo.documents.length - 1; iCounter <= goTo; iCounter++ ) {
							oDocConfig = oProdInfo.documents[iCounter];

							jQuery("#child_doc_download").append('<span><a target="_blank" href="' + oDocConfig.file + '">' + oDocConfig.link + '</a><br> </span>');
						} //- for ( var iCounter = 0, goTo = oProdInfo.documents.length - 1; iCounter <= goTo; iCounter++ )

						/*
						 * Hide Parent Docs & Show Child Docs
						 */
						jQuery('#doc_download').hide();
						jQuery('#child_doc_download').show();

					} else {

						/*
						 * Hide Child Docs
						 */
						jQuery('#child_doc_download').hide();

						/*
						 * Show Parent Docs - If there are any
						 */
						if ( jQuery('#doc_download').find('span').eq(1).html() == '' ) {
							jQuery('doc_download').hide();
						} else {
							jQuery('#doc_download').show();
						} //- if ( jQuery("#doc_download").find('span').eq(1).html() == '' )

					} //- if( oProdInfo.documents.length > 0 )

				} //- if ( bUseChildDocs )

				/*
				 * Child Product Qty Pricing
				 *
				 * @author	johns
				 * @since	11/6/2010
				 */
				if ( bShowChildQtyPricing ) {

					if ( 'showPriceBreaks' in oProdInfo ) {

						if (oProdInfo.showPriceBreaks) {
							jQuery('#qtypricing').html('<a href="i_i_priceBreakPopup.asp?p_id=' + sPKey + '&p_key=' + sPKey + '&TB_iframe=true&height=400&width=400&modal=false" title="Qty Pricing" class="thickbox">' + sQtyPricingLinkLabel + '</a>');
							tb_init('#qtypricing a'); /* jonr - 11/12/10 - We have to reinitialize Thickbox after modifying the DOM */
						} // -if (oProdInfo.showPriceBreaks)

					} //- if ( 'showPriceBreaks' in oProdInfo )

				} //- if ( bShowChildQtyPricing )

				/*
				 * Use Child Product Description
				 *
				 * @author	johns
				 * @since	11/6/2010
				 */
				if ( bUseChildDescription ) {

					if ( 'desription' in oProdInfo ) {

						if ( oProdInfo.desription ) {
							jQuery('#detail_desc_content_0').html(oProdInfo.desription);
						} //- if ( oProdInfo.desription )

					} //- if ( 'ds' in oProdInfo )

				} //- if ( bUseChildDescription )

				/*
				 * Add Code to show/hide review message and buttons.
				 *
				 * @author	pijushb
				 * @since	1/24/2012
				 */
				if ( bShowBackOrderMessage ) {

					sPrevSku 		= jQuery('#previous_sku').val();
					bReviewMessage 	= jQuery('#review_message_' + sPrevSku).is(':visible')

					if ( bReviewMessage ) {
						jQuery("#review_message_"+sPrevSku).hide();
					} //- if ( bReviewMessage )
					
					bSubmitButton = jQuery('#submit_button').is(':visible')

					if ( ! bSubmitButton ) {

						 jQuery('#submit_button').show();
						 jQuery('#check_stock_button').show();
						 jQuery('#checkout_button').hide();

					} //- if ( ! bSubmitButton )

				} //- if ( bShowBackOrderMessage )

				if ( bUseProductAliases ) {

					if ( 'pa_key' in oProdInfo ) {

						if ( oProdInfo.pa_key ) {
							jQuery('#pa_id').html(oProdInfo.pa_key);
						} //- if ( oProdInfo.pa_key )

					} //- if ( 'pa_key' in oProdInfo )

				} //- if ( bUseProductAliases )

				/*
				 * Displaying Config Data
				 * @auther - vinayakj
				 * @since - 5/2/2012
				 */
				if ( bShowProdConfig ) {
					
					if ('prod_config_droplist' in oProdInfo) {
		                jQuery('#config_sections_container').html(htmlDecode(oProdInfo.prod_config_droplist));
					} else {
						jQuery('#config_sections_container').html('');
					}
					
					/*
					 * Put Config Keys
					 */
					if ( 'config_keys' in oProdInfo) {
						jQuery('#config_keys').val(oProdInfo.config_keys);

						if ( jQuery('#qty_box').length > 0 )
							jQuery('#qty_box').attr('name', 'qty_' + oProdInfo.config_keys);
					}					

					/*
					 * Put use_parent_key
					 */
					if ( 'use_parent_key' in oProdInfo) {
						jQuery('#use_parent_key').val(oProdInfo.use_parent_key);
					}
					
					/*
					 * Put show_config_sections
					 */
					if ('show_config_sections' in oProdInfo) {
						
						jQuery('#show_config_sections').val(oProdInfo.show_config_sections);
						if (oProdInfo.show_config_sections == "1")
						{
							jQuery.ajax({ 
								url: '?pageaction=getconfigdata&config_key=' + jQuery('#config_keys').val() + '&key='
								, cache: false
								, dataType: "html"
								, success: function(sResponse){ 
									 jQuery('#config_sections_container').html(htmlDecode(sResponse));
								}
							});
						} else {
							jQuery('#config_sections_container').html('');
						}
					}

	            }

			} catch ( oError ) {
				alert('fncProcessOptProduct(' + vOpt + '): ' + oError.message);
				hideProductContainer();
			}

		} //- function fncProcessOptProduct ( vOpt )

		function htmlDecode(value) {
			if (value) {
				return $('<div />').html(value).text();
			} else {
				return '';
			}
		}
		
		/**
		 * Draw UOM Table
		 *
		 * @author	johns
		 * @since	3/17/2011
		 * @param	sPKey	string - the key of the product we are looking at
		 *			oData	object - object containing the data from the ajax call
		 *
		 * @return	UOM Table HTML
		 */
		function fncDrawUOM( sPKey, oData ) {
			try {
				
				/*
				 * if the product price is blank, then exit the function
				 */
				if ( oData.price == '&nbsp;' ) {
					sUOMHtml = '';
					return sUOMHtml;
				}
				
				/*
				 * var containing html table structure to displayed containing the data
				 */
				var sUOMHtml = '';
				var sQtyPerUnitColumn = '';
				
				/*
				 * make sure at least one of the show uom booleans is true
				 */
				if ( bShowSalesUOM || bOnlyShowSalesUOM || bShowAdditionalSalesUOM ) {

					/*
					 * display title and hidden fields for the product
					 */
					sUOMHtml += '<h2>Add to Cart</h2>';

					if ( 'uomStd' in oData ) {
						sUOMHtml += '<input type="hidden" name="uom_std_' + sPKey + '" value="' + oData.uomStd + '" />';
					}

					if ( 'uomSales' in oData ) {
						sUOMHtml += '<input type="hidden" name="uom_sales_' + sPKey + '" value="' + oData.uomSales + '" />';
						sUOMHtml += '<input type="hidden" name="uom_conv_' + sPKey + '" value="' + oData.uomSalesConversion + '" />';
					}

					sUOMHtml += '<input type="hidden" name="price_uom_' + sPKey + '" value="' + oData.uomPrice + '" />';
					
					/*
					 * determine whether or not to show the Qty Per Unit column
					 */
					if ( bShowQtyPerUnitColumn ) {
						sQtyPerUnitColumn = '<td>Qty Per Unit</td>';
					} //- if ( bShowQtyPerUnitColumn )
						
					sUOMHtml += '<table class="DDT-wrap">';
					sUOMHtml += '<tr class="headrow"><td>Unit</td>' + sQtyPerUnitColumn + '<td>' + sUnitPriceColumnLabel + '</td><td>Qty</td></tr>';

					if ( bShowSalesUOM && ! bOnlyShowSalesUOM ) {
					
						/*
						 * determine whether or not to show the Qty Per Unit column
						 */
						if ( bShowQtyPerUnitColumn ) {
							sQtyPerUnitColumn = '<td>1</td>';
						} //- if ( bShowQtyPerUnitColumn )
							
						/*
						 * draw Standard UOM row
						 */
						if ( 'uomStd' in oData ) {

							sUOMHtml += '<tr><td>' + oData.uomStd + '</td>' + sQtyPerUnitColumn + '<td>' + oData.price + '</td><td>';

							sUOMHtml += fncDrawQtyBox( sPKey, oData.qtyDisplayType, oData.uomStd, '' );

							sUOMHtml += '</td></tr>';

						} //- if ( 'uomStd' in oData )
							
						if ( 'uomSales' in oData ) {

							if ( oData.uomSales != '' && oData.uomSalesConversion > 1 && oData.uomSales != oData.uomStd ) {
						
								/*
								 * determine whether or not to show the Qty Per Unit column
								 */
								if ( bShowQtyPerUnitColumn ) {
									sQtyPerUnitColumn = '<td>' + oData.uomSalesConversion + '</td>';
								} //- if ( bShowQtyPerUnitColumn )

								
								if ( typeof oData.uomSalesUnitPrice == 'undefined' ) {
									iUnitPrice = 0;
								} else {
									iUnitPrice = oData.uomSalesUnitPrice
								} //- if ( typeof oUomConfig.uomSalesUnitPrice == 'undefined' )

								/*
								 * draw UOM Sales row
								 */					
								sUOMHtml += '<tr><td>' + oData.uomSales + '</td>' + sQtyPerUnitColumn + '<td>$' + parseFloat(iUnitPrice).toFixed(2) + '</td><td>';

								sUOMHtml += fncDrawQtyBox( sPKey, oData.qtyDisplayType, oData.uomSales, 'sales_' );

								sUOMHtml += '</td></tr>'

							} //- if ( 'uomSales' in oData && 'uomSalesConversion' in oData )3

						} //- if ( 'uomSales' in oData )

						if ( bShowAdditionalSalesUOM ) {

							if ( 'uomAdditional' in oData && oData.uomAdditional.length > 0 ) {
								
								/*
								 * draw additional uom rows
								 */
								for ( var iCounter = 0, iGoTo = oData.uomAdditional.length; iCounter < iGoTo; iCounter++ ) {

									var oUomConfig	= oData.uomAdditional[iCounter];
									var sQtyPerHTML	= '';

									if ( typeof oUomConfig != 'undefined' && typeof oUomConfig.conversion != 'undefined' ) {

										var sThisUom = iCounter + 1
					
										/*
										 * determine whether or not to show the Qty Per Unit column
										 */
										if ( bShowQtyPerUnitColumn ) {

											/*
											 * calculating the qty per unit
											 */
											if ( iUOMConversion < 1 ) {
												iQty = 1 / iUOMConversion
											} else if ( iUOMConversion >= 1 ) {
												iQty = iUOMConversion
											} //- if ( iUOMConversion < 1 )

											sQtyPerHTML	= '<td>' + iQty.toFixed() + '<input type="hidden" name="uom' + sThisUom + '_conv_' + sPKey + '" id="uom' + sThisUom + '_conv_' + sPKey + '" value="' + oUomConfig.conversion + '" /></td>';
										} else {
											sQtyPerHTML = '<input type="hidden" name="uom' + sThisUom + '_conv_' + sPKey + '" id="uom' + sThisUom + '_conv_' + sPKey + '" value="' + oUomConfig.conversion + '" />'
										} //- if ( bShowQtyPerUnitColumn )

										if ( typeof oUomConfig.unitPrice == 'undefined' ) {
											iUnitPrice = 0;
										} else {
											iUnitPrice = oUomConfig.unitPrice;
										} //- if ( typeof oUomConfig.unitPrice == 'undefined' )
										
										/*
										 * build the html w/ hidden inputs
										 */
										sUnitHTML	= oUomConfig.unit + '<input type="hidden" name="uom' + sThisUom + '_' + sPKey + '" id="uom' + sThisUom + '_' + sPKey + '" value="' + oUomConfig.unit + '" />';									
										sPriceHTML	= '$' + parseFloat(iUnitPrice).toFixed(2) + '<input type="hidden" name="uom' + sThisUom + '_price_per_' + sPKey + '" id="uom' + sThisUom + '_price_per_' + sPKey + '" value="' + iUnitPrice.toFixed(2) + '" />';

										sUOMHtml += '<tr><td>' + sUnitHTML + '</td>' + sQtyPerHTML + '<td>' + sPriceHTML  + '</td><td>';

										sUOMHtml += fncDrawQtyBox( sPKey, oData.qtyDisplayType, oUomConfig.conversion, 'uom' + sThisUom + '_' );
										
										sUOMHtml += '</td></tr>'

									} //- if ( typeof oUomConfig != 'undefined' && typeof oUomConfig.conversion != 'undefined' )
										
								} //- for ( var i = 0, goTo = oProdInfo.documents.length - 1; i <= goTo; i++ )

							} //- if ( 'uomAdditional' in oData )
							
						} //- if ( bShowAdditionalSalesUOM )
						
					} else if ( ! bShowSalesUOM && bOnlyShowSalesUOM ) {
						
						/*
						 * only draw UOM Sales row
						 */					
						sUOMHtml += '<tr><td>' + oData.uomSales + '</td><td>1</td><td>$' + parseFloat(oData.uomSalesUnitPrice).toFixed(2) + '</td><td>';

						sUOMHtml += fncDrawQtyBox( sPKey, oData.qtyDisplayType, oData.uomSales );

						sUOMHtml += '</td></tr>'

					} //- if ( bShowSalesUOM )

					sUOMHtml += '</table>'

					/*
					 * Add to Cart button
					 */
					if ( oData.showCart ) {
						sUOMHtml += '<label class="atc">';
							sUOMHtml += '<input type="submit" name="submit" id="submit_button" value="Add to Cart" class="btn_addtocart chrome" />';
						sUOMHtml += '</label>';
					}
					
				} //- if ( bShowSalesUOM || bOnlyShowSalesUOM || bShowAdditionalSalesUOM )

				return sUOMHtml;
				
			} catch ( err ) {

				alert('function: fncDrawUOM - ' + err.message);
				return '';

			}

		} //- function fncDrawUOM( sPKey, oData )
		
		/**
		 * Draw Qty Box for UOM Table
		 *
		 * @author	johns
		 * @since	3/17/2011
		 * 
		 * @returns	void
		 */
		function fncDrawQtyBox( sPKey, sQtyDisplayType, sEachField, sPrefix ) {
			try {

				/**
				 * Qty Input Display var
				 */
				var bUseQtyByUnitQtyDisplay = false;
				var sQtyInputHtml = '';

				if ( bUseQtyByUnitQtyDisplay ) {
				
					if ( sQtyDisplayType == 'sets' ) {

						sQtyInputHtml += '<input type="text" name="' + sPrefix + 'qty_display_' + sPKey + '" id="' + sPrefix + 'qty_display_' + sPKey + '" class="' + sPrefix + 'qty_display" value="" size="1" style="text-align:center" onfocus="this.select();"> @';

						sQtyInputHtml += '<input type="text" name="' + sPrefix + 'units_per_qty_display_' + sPKey + '" id="' + sPrefix + 'units_per_qty_display_' + sPKey + '" class="' + sPrefix + 'units_per_qty_display" size="1" style="text-align:center" value="" onfocus="this.select();"> ' + sEachField + ' (s) each.';

					} else {
						sQtyInputHtml += '<input type="text" name="' + sPrefix + 'qty_' + sPKey + '" id="qty_' + sPKey + '" class="qtyinput" value="" onfocus="this.select();">'
					} //- if ( oData.qtyDisplayType == 'sets' )
									
				} else {
					sQtyInputHtml += '<input type="text" name="' + sPrefix + 'qty_' + sPKey + '" id="qty_' + sPKey + '" class="qtyinput" value="" onfocus="this.select();">'
				}

				return sQtyInputHtml;
				
			} catch (err) {

				alert('function: fncDrawQtyBox<br/ >' + err.message);
				return '';

			}

		} //- function fncDrawQtyBox( sPKey, oData, sEachField )


		/*
		 * This will build out the Cart Options with comments
		 * @auther - vinayakj
		 * @since - 8/28/2012
		 */
		function buildCartOptWithComments(rowkey,sCartOptions,RowID){

			if (jQuery('#parent_p_key').val() != '') {
				rowkey = jQuery('#parent_p_key').val();
			} else {
				rowkey = jQuery('#keys').val();
			}

			buildCartOpt(rowkey);
		}


		function buildCartOption ( PKey, sOptions, Num ) {
			

			/*
			 * Get the cart options
			 */
			aCartOpts = sOptions.split("|");
			
			/*
			 * Clear the cart option container and start building it
			 * with the new cart options
			 */
			jQuery('#pc_cart_options_' + Num).remove('.atc').html('<input type="hidden" id="keys_' + PKey + '" value="' + PKey + '">');

			var aOptInputs	= Array();
			var aLimitIds	= Array();
			
			/*
			 * Loop all the cart options, and append each to the cart
			 * option container.
			 */
			for ( var iOpt = 0, goTo = aCartOpts.length; iOpt < goTo; iOpt++ ) {
				aCartOpt = aCartOpts[iOpt].split('~');
				
				sDisplay	= aCartOpt[0];
				sLabel		= aCartOpt[1];
				sType		= aCartOpt[2];
				sAnswers	= aCartOpt[3];

				if ( aCartOpt.length >= 4 ) {
					sCharLimit	= aCartOpt[4];
				} //- if ( aCartOpt.length >= 4 )
				
				/*
				 * Character Limit Logic
				 */
				bUseLimit = (sCharLimit != '0' && sCharLimit != '' ? true : false);
				
				/*
				 * Input Id
				 */
				sOptId = 'cart_opt_' + iOpt + '_' + PKey;

				/*
				 * Begin building this option
				 */
				sHtml = '<label class="atc"><span>' + sDisplay + '</span>';
				
				switch ( sType ) {

					case 'select':
						sJsEvent = 'change';

						sHtml += '<select id="' + sOptId + '">';
						sHtml += getCartOptOptions(sAnswers);
						sHtml += '</select>';
						break;

					case 'text-area':
						sJsEvent = 'blur';

						sHtml += '<textarea id="' + sOptId + '"></textarea>';
						break;

					default:
						sJsEvent = 'blur';

						sHtml += '<input type="text"  maxlength="' + sCharLimit + '" id="' + sOptId + '"/>';
						break;

				} //- switch ( sType )
						
				/*
				 * Add the character limit message
				 */
				if(bUseLimit){
					sHtml += '<div id="' + sOptId + '_limit">You have ' + sCharLimit + ' characters left.</div>';				
				}
				
				sHtml += '</label>';

				/*
				 * Append the option to the container
				 */
				jQuery('#pc_cart_options_' + Num).append(sHtml);
						
				/*
				 * Register char counter event listener
				 */
				if(bUseLimit){
					jQuery('#' + sOptId).live('keyup', {optId: sOptId, optLimit: sCharLimit}, function(event){
						limitChars(event.data.optId, event.data.optLimit, event.data.optId + '_limit');
					});
				}//-if(bUseLimit)

				/*
				 * Register input event listener
				 */
				jQuery('#' + sOptId).live(sJsEvent, {optId: sOptId, pkey: PKey}, function(event){
					buildCartOpt(event.data.pkey);
				});

			} //- for ( var iOpt = 0, goTo = aCartOpts.length; iOpt < goTo; iOpt++ )

			
			jQuery('#pc_cart_options_' + Num).append('<input type="hidden" name="cart_option_' + PKey + '" id="cart_option_' + PKey + '" />');

		} //- function buildCartOption ( PKey, sOptions, Num )

		function getCartOptOptions(sAnswers){
			
			aAnswers = sAnswers.split(";");

			sHtml = '<option value="">[Select One]</option>';
			for(i = 0, goTo = aAnswers.length; i < goTo; i++){
				sHtml += '<option value="' + aAnswers[i] + '">' + aAnswers[i] + '</option>';
			}
			
			return sHtml;

		}//-getCartOptOptions

		function limitChars(textid, limit, infodiv){
			var text = jQuery('#' + textid).val(); 
			var textlength = text.length;

			if (textlength > limit) {
				jQuery('#' + infodiv).html('You cannot write more then '+limit+' characters!');
				jQuery('#' + textid).val(text.substr(0,limit));
				return false;

			} else {

				jQuery('#' + infodiv).html('You have '+ (limit - textlength) +' characters left.');
				return true;
			}
		}//-function limitChars

		function fncProcessSizeProduct(){

			try{

				var sPKey 					= jQuery('#prod_opt2').val();
				var bUseChildDescription 	= false;
				var oProdInfo 				= window.oChildProds[sPKey];

				if ( sPKey == '' ) {
					hideProductContainer();
					return false;
				}

				jQuery('#qty_box').attr( 'name', 'qty_' + sPKey );
				jQuery('#keys').val( sPKey );

				/*
				 * Test if this is the "last" droplist being displayed
				 */
				if ( jQuery('#pc_cart_options_2').length > 0 ) {

					jQuery('#pc_cart_options_2').slideDown();
					
					/* 
					 * Change name to post item to the cart
					 */
					jQuery('#cart_option_79CA3421E53B4167AABDE2C1136CA5DA').attr('name','cart_option_' + sPKey);

				} //- if ( jQuery('#pc_cart_options_2').length > 0 )
				
				/*
				 * SKU
				 */
				jQuery('#sku_container').html( 'SKU: ' + oProdInfo.sku );
				
				/*
				 * Cart
				 */
				if ( oProdInfo.showCart ) {
					jQuery('#atc_container').show();
				} else {
					jQuery('#atc_container').hide();
				} //- if ( oProdInfo.showCart )
							
				/*
				 * Unit of Measure
				 */
				if ( 'uomHTML' in oProdInfo ) {

					if ( oProdInfo.uomHTML != '' )
						jQuery('#detail_atc_standalone').html(oProdInfo.uomHTML);

				} //- if ( 'uomHTML' in oProdInfo )
				
				/*
				 * Price
				 */
				
				if ( oProdInfo.showPrice ) {
					iRetailPrice	= parseFloat(oProdInfo.retail_price.replace('$','')); 
					iPrice          = parseFloat(oProdInfo.price.replace('$','')); 

					if ( iPrice < iRetailPrice ) {
						iPercent		= (iRetailPrice - iPrice) / iRetailPrice; 
						iPercentSaved	= iPercent * 100;

						jQuery('#price_container').html('<ul class="detail_pricing"><li class="saleprice">' + oProdInfo.price + '</li><li class="listprice">List Price: <span class="strike">' + oProdInfo.retail_price + '</span></li><li class="savings">You Save: ' + Math.round(iPercentSaved*100)/100 + '%</li></ul>');
					} else {
						jQuery('#price_container').html('<ul class="detail_pricing"><li class="saleprice">' + FormatCurrency(oProdInfo.price, true) + '</li></ul>');
					} //-if(iPrice < iRetailPrice)

				} //- if(oProdInfo.showPrice)
				
				
				/*
				 *Add hidden field for qty available to check back order.
				 *@author pijushb
				 *@since 9/28/2011
				 */
				 if ( bShowBackOrderMessage ) {

					jQuery('.qtyavailable').remove();
						jQuery('#idp_container')
							.parent()
							.append('<div id=review_message_'+sPKey+' style="display: none;"></div><input class="qtyavailable" type=hidden id=qty_available_'+sPKey+' value='+oProdInfo.qty_available+'>')
				 } //- if (bShowBackOrderMessage)

				/*
				 * Use Child Product Description
				 *
				 * @author	johns
				 * @since	11/6/2010
				 */
				if ( bUseChildDescription ) {

					if ('desription' in oProdInfo) {

						if (oProdInfo.desription) {
							jQuery('#detail_desc_content_0').html(oProdInfo.desription);
						} //- if (oProdInfo.ds)

					} //- if ('ds' in oProdInfo)

				} //- if (bUseChildDescription)

				if ( bUseProductAliases ) {

					if ( jQuery.trim(oProdInfo.pa_key) != '' ) {
						jQuery('#pa_id').val(oProdInfo.pa_key);
						jQuery('#pa_id').attr('name','pa_id_' + sPKey);
					} //- if jQuery.trim(oProdInfo.pa_key) != '' )

				} //- if ( bUseProductAliases )

				/*
				 * Inventory
				 */
				if ( oProdInfo.showInventory ) {
					jQuery('#idp_container').html(oProdInfo.invMsg);

					/*
					 * if status = out then show "add product to watch list" link
					 *
					 * @author johns
					 * @since 12/11/2009
					 */
					
				} //- if ( oProdInfo.showInventory )

				/*
				 * Append Favorite link with Child Product Key
				 * @auther - vinayakj
				 * @since - 6/5/2012
				 */
				if (bShowFavoriteLink && bShowChildFavoriteLink && jQuery('#idp_container li[id="addfave"]').length === 0) {
					jQuery('#idp_container').append('<ul id="detail_links" class="clearfix"><li id="addfave" ><a href="i_i_add_product_to_favorites.asp?p_id=' + sPKey + '&TB_iframe=true&height=400&width=400&modal=false" title="Add to Favorites" class="thickbox">Add to Favorites</a></li></ul>');

					tb_init('#idp_container a.thickbox, area.thickbox, input.thickbox');
				}

				/*
				 * Displaying Config Data
				 * @auther - vinayakj
				 * @since - 5/2/2012
				 */
				if ( bShowProdConfig ) {
					
					if ( 'prod_config_droplist' in oProdInfo) {
						jQuery('#config_sections_container').html(htmlDecode(oProdInfo.prod_config_droplist));
					} else {
						jQuery('#config_sections_container').html('');
					}
					
					/*
					 * Put Config Keys
					 */
					if ( 'config_keys' in oProdInfo) {
						jQuery('#config_keys').val(oProdInfo.config_keys);
					}

					/*
					 * Put use_parent_key
					 */
					if ( 'use_parent_key' in oProdInfo) {
						jQuery('#use_parent_key').val(oProdInfo.use_parent_key);
					}
					
					/*
					 * Put show_config_sections
					 */
					if ( 'show_config_sections' in oProdInfo) {
						jQuery('#show_config_sections').val(oProdInfo.show_config_sections);
					}
				}

			} catch ( oError ){
				alert(oError.message);
				hideProductContainer();
			}

		}//-function fncProcessSizeProduct

		function fncSelectAddon(){
			//Update Design Key & Qty
			document.getElementById('design_keys_'+sGroup).value = sDesignKey;
			document.getElementById('design_qty_'+sGroup).name = 'ED8EF1597D7F4D0797F652145C64714C_' + sDesignKey + '_qty'; 
		}

		function InArray(vArray, vValue){
			for (var iOpt = 0; iOpt < vArray.length; iOpt++){
				if (vArray[iOpt]==vValue){
					return true;
				}
			}
			return false;
		}

		function ResizeLoadingBG ( bDisableDroplistForm ) {

			if ( bDisableDroplistForm === 'undefined' ) fncDisableDroplistForm();

			var oLBG = document.getElementById('detailloadingbg');
			var oLPic = document.getElementById('detailloadingpic');

			var popwidth = 200;

			if (window.innerHeight && window.scrollMaxY) {
				oLBG.style.width = document.body.scrollWidth;
				oLBG.style.height = window.innerHeight + window.scrollMaxY;
			} else if (document.body.scrollHeight > document.body.offsetHeight){ // all but Explorer Mac
				oLBG.style.width = document.body.scrollWidth;
				oLBG.style.height = document.body.scrollHeight;
			} else { // Explorer Mac...would also work in Explorer 6 Strict, Mozilla and Safari
				oLBG.style.width = document.body.offsetWidth;
				oLBG.style.height = document.body.offsetHeight;
			}

			if (self.innerHeight) {	// all except Explorer
				oLPic.style.left = (self.innerWidth / 2) - (popwidth / 2);
				oLPic.style.top = self.pageYOffset + (self.innerHeight / 4);
			} else if (document.documentElement && document.documentElement.clientHeight) { // Explorer 6 Strict Mode
				oLPic.style.left = (document.documentElement.clientWidth / 2) - (popwidth / 2);
				oLPic.style.top = document.documentElement.scrollTop + (document.documentElement.clientHeight / 4);
			} else if (document.body) { // other Explorers
				oLPic.style.left = (document.body.clientWidth / 2) - (popwidth / 2);
				oLPic.style.top = document.body.scrollTop + (document.body.clientHeight / 4);
			}

			oLBG.style.display = 'block';
			oLPic.style.display = 'block';

		}

		function HideLoading(){
			document.getElementById('detailloadingbg').style.display = 'none';
			document.getElementById('detailloadingpic').style.display = 'none';
			fncEnableDroplistForm();
		}

		function createXMLDoc(XMLFile) {
			// code for IE
			if (window.ActiveXObject){
				xmlDoc = new ActiveXObject("Microsoft.XMLDOM");
				xmlDoc.loadXML(XMLFile);
			// code for Mozilla, Firefox, Opera, etc.
			} else if (document.implementation && document.implementation.createDocument){
				//xmlDoc = document.implementation.createDocument("", "", null);
				var parser = new DOMParser();
				var xmlDoc = parser.parseFromString(XMLFile, "text/xml");
			} else {
				alert('Your browser cannot handle this script.');
			}

			return(xmlDoc);
		}

		function getNodeValue(xmlDoc, tagName, index) {
			if (xmlDoc.getElementsByTagName(tagName)[index].childNodes[0] != null)
				return xmlDoc.getElementsByTagName(tagName)[index].childNodes[0].nodeValue;
			else
				return '';
		}

		function MakeAJAXRequest(fncHandleData, strPage, bAsync, aShow, aHide, bDisable, errorMsg, xmlDoc, vID) {
			ResizeLoadingBG();
			xmlHttp = GetXmlHttpObject();
			if (xmlHttp==null){
				alert ("Your browser does not support AJAX.");
				return;
			}

			if (bDisable == null){
				bDisable = false;
			}

			var i;

			try{
				if (aShow != null){
					for (i = 0; i < aShow.length; i++){
						if (bDisable==true){
							document.getElementById(aHide[i]).disabled = false;
						} else {
							document.getElementById(aShow[i]).style.display = 'block';
						}
					}
				}
			}
			catch (err){
				alert(err.message);
			}

			try{

				if (aHide != null){
					for (i = 0; i < aHide.length; i++){
						if (bDisable==true){
							document.getElementById(aHide[i]).disabled = true;
						} else {
							document.getElementById(aHide[i]).style.display = 'none';
						}
					}
				}
			}
			catch (err){
				alert(err.message);
			}

			

			xmlHttp.open('get', strPage + '&r_id=' + genID(), bAsync);
			xmlHttp.onreadystatechange = function() { HandleData(fncHandleData, errorMsg, vID) };
			if (xmlDoc == undefined){
				xmlDoc = null;
			}
			xmlHttp.send(xmlDoc);
		}

		function HandleData(fncHandleData, errorMsg, vID) {
			if (errorMsg == undefined || errorMsg == "") errorMsg = "An error has occured."
			if(xmlHttp.readyState == 4) { //Finished loading the response
				//var xmlDoc = xmlHttp.responseXML.documentElement;
				//alert(xmlHttp.responseText);
				xmlDoc = createXMLDoc(xmlHttp.responseText);

				if (xmlDoc == null)	{
					alert(errorMsg);
					HideLoading()
				} else {
					fncHandleData(xmlDoc, vID);
				}

			}
		}

		function NumbersOnly(myfield, e){
			var key;
			var keychar;

			if (window.event)
			   key = window.event.keyCode;
			else if (e)
			   key = e.which;
			else
			   return true;
			keychar = String.fromCharCode(key);

			// control keys
			if ((key==null) || (key==0) || (key==8) || (key==9) || (key==27) ){
				//alert('control keys');
				return true;

			// no enters
			} else if ((key==13) || (key==32)){
				//alert('no enters');
				return false;

			// only one deicmal
			} else if (keychar=='.' && myfield.value.indexOf('.')>-1){
				//alert('only one deicmal');
				return false;

			// numbers
			} else if ((("0123456789").indexOf(keychar) > -1)){
				//alert('numbers');
				return true;

			// isNaN
			} else if (isNaN(myfield.value)){
				//alert('isNaN');
				myfield.value = '';
				return false;

			} else {
				//alert('Else');
				return false;
			}
		}

		// Open lightbox
		function fncDrawFindPopup(popwidth,popheight,searchtype,showsearch,key,qstring){
			//document.getElementById('lb_open_type').value = searchtype;

			//var ckey = childkey.replace('?', '');

			lightbox_pageScrollX = document.body.scrollLeft;
			lightbox_pageScrollY = document.body.scrollTop;
			lightbox_bIsOpen = true;

			document.getElementById('popup').style.width=popwidth + 'px';
			document.getElementById('popup').style.height=popheight + 'px';

			document.getElementById('lostfocus').style.display = 'block';
			document.getElementById('popup').style.display = 'block';

			lightbox_Position();

			document.getElementById('searchtype').value=searchtype;
			//document.getElementById('lightbox_header').innerHTML=header;
			document.getElementById('popup_search_text').value='';
			document.getElementById('popupdesc').innerHTML='';

			if (showsearch == '0'){
				document.getElementById('popup_search_section').style.display='none';
			}

			// Fix IE for DTD 4.0
			if (ie && document.documentElement && document.compatMode == 'CSS1Compat') {
				document.getElementById('popup_search_results_container').style.height = (document.getElementById('popup_search_results_container').offsetHeight - 1 - (document.getElementById("popupheader").offsetHeight + document.getElementById("popupdesc").offsetHeight + document.getElementById("popup_search_section").offsetHeight)) + 'px';
			}

			document.getElementById('lostfocus').style.visibility = 'visible';
			document.getElementById('popup').style.visibility = 'visible';

			//document.getElementById('popup_search_results').innerHTML = '<iframe src="">'
			GetResults('crazycanoe.asp',key,qstring);
		}

		// Create an XMLHttpRequest object
		function createRequestObject(){
			var request_o;
			var browser = navigator.appName;
			if(browser == "Microsoft Internet Explorer"){
							request_o = new ActiveXObject("Microsoft.XMLHTTP");
			}else{
							request_o = new XMLHttpRequest();
			}
			return request_o;
		}

		// AJAX call for Lightbox
		function GetResults(pagename,key,qstring) {
			document.getElementById('popup_search_results').innerHTML = '<div style="text-align: center;">Loading page. Please wait...</div>';
			var requestUrl = 'i_i_' + pagename + '?' + qstring + '&key=' + key;
			http = createRequestObject();
			http.open('get', requestUrl);
			http.onreadystatechange = WriteResults;
			http.send(null);
		}

		// Content for Lightbox
		function WriteResults() {
			if(http.readyState == 4) { //Finished loading the response
				var response = http.responseText;

				document.getElementById('popup_search_results').innerHTML = response;
			}
		}

		// Close Lightbox
	/*	function lightbox_LostFocus(){
			lightbox_bIsOpen = false;
			document.getElementById('lostfocus').style.visibility='hidden';
			document.getElementById('popup').style.visibility='hidden';
			document.getElementById('lostfocus').style.display='none';
			document.getElementById('popup').style.display='none';
			//GetODTs();  //Use if refreshing a DDT.
		}
	*/
		function FormatCurrency(num, useSign) {
			num = num.toString().replace(/\$|\,/g,'');
			if(isNaN(num))
				num = "0";
			sign = (num == (num = Math.abs(num)));
			num = Math.floor(num*100+0.50000000001);
			cents = num%100;
			num = Math.floor(num/100).toString();
			if(cents < 10)
				cents = "0" + cents;
			for (var i = 0; i < Math.floor((num.length-(1+i))/3); i++)
				num = num.substring(0,num.length-(4*i+3))+','+
			num.substring(num.length-(4*i+3));
			if (useSign)
				return (((sign)?'':'-') + '$' + num + '.' + cents);
			else
				return (((sign)?'':'-') + num + '.' + cents);
		}

		function addChildRows(rows){
			try {
				var tbody = document.getElementById('cart_option_rows');
				var newrow ;
				var rowkey;
				for ( var i = 1; i <= rows; i++ ) {	

					rowkey = randomString();

					/**
					 * When Adding the row, only create the drop list input until a selection
					 * is made so that we can build a standard ATC format
					 */
					jQuery('#cart_option_rows').append('<tr id="' + rowkey + '"></tr>');

					var sHTML = '<td id="product_' + rowkey + '" class="prod-td-list"><img id="loading_' + rowkey + '" src="common_images/ajax-loader_01.gif" /></td>'; //qty
					sHTML = sHTML + '<td id="td_' + rowkey + '" class="prod-td-qty">-</td>'; //qty 				
						
					if (bShowCartOpts) {
						aCartOpts = sCartOptions.split("|");

						for (var iCartOptCounter = 0, iCartOptGoTo = aCartOpts.length - 1; iCartOptCounter <= iCartOptGoTo; iCartOptCounter++) {

							sCartOpts = aCartOpts[iCartOptCounter].split('~');

							try {
								sHTML += '<td id="cart_opt_td_' + iCartOptCounter + '_' + rowkey + '" class="prod-td-opt' + iCartOptCounter + '"><em>' + sCartOpts[1] + '</em></td>'; //cart option
							} catch(err) {
								alert(err.message);
							}
						}
					}

					sHTML = sHTML + '<td id="price_' + rowkey + '" class="prod-td-price">-</td>'; //price
					sHTML = sHTML + '<td id="remove_' + rowkey + '" class="prod-td-remove"><a href="javascript:void(0)" onclick="this.parentNode.parentNode.parentNode.removeChild(this.parentNode.parentNode);">Remove</a></td>'; //remove
					
					jQuery('#' + rowkey).append(sHTML);
					
				}

				var row;
				var pSelect;
				var pOption;
				
				jQuery('#cart_option_rows').children().each(function() {

					/*
					 * check for rows that have not had the Product drop list built
					 * row = tbody.childNodes[i];
					 */
					id		= jQuery(this).attr('id');
					pSelect	= '';

					if ( ! document.getElementById('keys_' + id) ) {
						
						pSelect += '<input type="hidden" name="row_id" id="row_id + ' + id + '" value="' + id + '" />';
						pSelect += '<select id="keys_' + id + '" name="keys" onchange="loadOptions(this);">';
						pSelect += '<option value="">[Select One]</option>';
						
						/*
						 * starting at 1 because the first item in the array is an empty object so that we can keep the selectIndex matched up with the products
						 */
						for ( var x = 1; x <= childItems.length - 1; x++ ) {
							pSelect += '<option value="' + childItems[x].key + '">';
							pSelect += childItems[x].nm + '</option>';
						} //- for ( var x=1; x <= childItems.length - 1; x++ )
						
						/*
						 * removes the loading image
						 */
						jQuery('#product_' + id).html(pSelect);

					} //- if ( ! document.getElementById('keys_' + id) )
				});

			} catch (err) {
				alert("Failed to load avaiable options. " + err.mesage);
			}	
		
		}
		
		var ajax_count = 0;

		function addRowsToCart(){
			//loop the rows in the table, requiring all cart options (if applicable)
			//MakeAJAXRequest(fncHandleData, strPage, bAsync, aShow, aHide, bDisable, errorMsg, xmlDoc, vID)

			try {
				var row;
				var tbody = document.getElementById('cart_option_rows');
				var cart_opt;
				var pkey;
				var qty;
				var bReturn = true;
				var bAddIt;
				var rowcount=0;
				var rowsToRemove = new Array();
				
				try {document.getElementById('cart_opt_req').style.display='none'; } catch (err){alert(err.message);}

				jQuery('#cart_option_rows').children().each(function() {

					//for (i=0; i<tbody.childNodes.length ; i++) {
					//check for rows that have had a Product selected
					//row = tbody.childNodes[i];
					id = jQuery(this).attr('id');
					pkey = jQuery('#keys_' + id).val();
					
					if (pkey != '') {
					
						//check the qty
						qty = jQuery('#qty_' + id).val();

						if (qty != '') {

							if (bShowCartOpts) {
								aCartOpts = sCartOptions.split("|");

								for (var iCartOptCounter = 0, iCartOptGoTo = aCartOpts.length; iCartOptCounter <= iCartOptGoTo; iCartOptCounter++) {

									cart_opt = jQuery('#cart_option_' + id).val();

									if (cart_opt == '') {
										jQuery('#cart_opt_req').show();
										bReturn = false;
										bAddIt = false;
									} else {
										bAddIt = true;
									} //cart option

								}
							} else {
								bAddIt = true;
							}

							//add it to the cart now
							if (bAddIt) {
								ajax_count++;
								MakeAJAXRequest(function(){ajax_count--;}, 'i_i_add_to_cart.asp?type=ajaxadd&perprodinstance=0&key=' + pkey + '&qty=' + qty + '&cart_option=' + cart_opt, true, [], [], true, 'There was an error adding your selection to the cart.', null, null)
							
								rowsToRemove[rowcount] = id;
								rowcount++;						
							}
						}
					
					}
				});

				if (!bReturn) {
					if (rowcount>0) {
						for (var r = rowsToRemove.length - 1; r >= 0; r--)
						{
							if (document.getElementById(rowsToRemove[r])) {
								tbody.removeChild(document.getElementById(rowsToRemove[r]));
							}
						}

						alert('All valid selections have been added to the cart. Please review the remaining items.');				
					}

					HideLoading();
					return false;
				} else{
					setTimeout('gotoCart()',1000);
					//window.location = "showcart.asp";
					return false;
				}
			} catch (err) {
				alert('error: ' + err.mesage);
				return false;
			}
		}
		
		function checkCartOpts(){
			try {
				if ( document.getElementById('cart_opt__79CA3421E53B4167AABDE2C1136CA5DA') ) { // check to make sure cart options are being used - johns - 7/19/2010
					buildCartOpt('79CA3421E53B4167AABDE2C1136CA5DA');
					try {document.getElementById('cart_opt_req').style.display='none'; } catch (err){alert(err.message);}
					var bReturn=true;

					if ( bReturn ) {
						return postToCart();
					} else {
						return false;
					} //- if ( bReturn )		
				} //- if ( document.getElementById('cart_opt__79CA3421E53B4167AABDE2C1136CA5DA') )
			} catch (err) {
				alert('Failed to check cart options. ' + err.mesage);
				return false;
			}	
		}

		var goto_count = 0;
		function gotoCart(){

			if (ajax_count==0 || goto_count==2){
				window.location = "https://winning-moves.com/showcart.asp";
			
			}
			else{
				goto_count++;
				setTimeout('gotoCart()',1000);
			
			}
		}

		function randomString() {
			var chars = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZ";
			var string_length = 12;
			var randomstring = '';
			try
			{
				for (var i=0; i<string_length; i++) {
					var rnum = Math.floor(Math.random() * chars.length);
					randomstring += chars.substring(rnum,rnum+1);
				}
				return randomstring;
				
			}
			catch (err)
			{
				alert('Key Failed: ' + err.mesage);
			}
		}
		
		function PriceFromBreaks(vRowID){
			var bShowATCPrice = false;
			var bShowRegPrice = false;
			var bShowATCQty	  = true;
			var iQty = parseInt(document.getElementById('qty_' + vRowID).value);
			var cFinalUnitPrice = childItems[document.getElementById('keys_' + vRowID).selectedIndex].price;

			if (isNaN(iQty)){
				iQty = 0;
			}

			if (iQty > 0){
				if (trim(childItems[document.getElementById('keys_' + vRowID).selectedIndex].qtybreaks)!=''){
					try{
						var xmlBreaks = createXMLDoc(childItems[document.getElementById('keys_' + vRowID).selectedIndex].qtybreaks);

							if (xmlBreaks.documentElement.childNodes.length > 0){
								try{
									for (var iNode = 0; iNode <= xmlBreaks.documentElement.childNodes.length; iNode++){
										var iNodeQty = parseInt(getNodeValue(xmlBreaks, 'QTY', iNode));

										//alert('Node: ' + iNode + '\nQuantity: ' + iQty + '\nBreak Quantity: ' + iNodeQty);

										if (iQty >= iNodeQty){
											cFinalUnitPrice = getNodeValue(xmlBreaks, 'Price', iNode);
										} else if (iQty < iNodeQty){
											break;
										}
									}
								} catch (err){
									alert(err.message);
								}
							}
					} catch (err){
						alert(err.message);
					}
				}
			}

			/*
			 * Set the Price based on Price Display Type and User Login session.
			 * @author pijushb
			 * @since 03/04/2011
			 */
			if (bShowPriceDisplayType) {
				switch (sPriceDisplayType) {
					case 'hide':
						document.getElementById('price_' + vRowID).innerHTML = "-";
						break;

					case 'show_message':
						document.getElementById('price_' + vRowID).innerHTML = (sPriceMessage);
						break;

					case 'require_atc':
						bShowATCPrice = true;
						break;

					case 'require_login_or_atc':
						
							bShowATCPrice = true;
						
						 break;
					
					case 'require_login_for_price_and_atc':
						
							bShowATCPrice	= false;
							bShowATCQty		= false;
						
						break;

					default: 
						bShowRegPrice = true;
						break;	
				}
			}
			
			if (bShowPriceDisplayType)
			{
				if (bShowRegPrice)
				{
					document.getElementById('price_' + vRowID).innerHTML = FormatCurrency(cFinalUnitPrice, true);
				}
				else if (bShowATCQty)
				{
					sTitle = "tip1"
					
					sHTML = '<a href="javascript:void(0);" onmouseover="Tip(\''+sTitle+'\',\''+sHelpText+'\',WIDTH, 400, DELAY,0, OFFSETX, -200, FADEIN, 200, FADEOUT, 200, FOLLOWMOUSE, false, ABOVE, true,OPACITY, 100, BALLOON, true);"><img align="absmiddle" src="common_images/b_helpicon.gif" border="0"/></a>';
					document.getElementById('price_' + vRowID).innerHTML = sHTML;
				}
				else
				{
					sTitle = "tip1"
					
					sHTML = '<a href="javascript:void(0);" onmouseover="Tip(\''+sTitle+'\',\''+sHelpTextLogin+'\',WIDTH, 400, DELAY,0, OFFSETX, -200, FADEIN, 200, FADEOUT, 200, FOLLOWMOUSE, false, ABOVE, true,OPACITY, 100, BALLOON, true);"><img align="absmiddle" src="common_images/b_helpicon.gif" border="0"/></a>';
					document.getElementById('price_' + vRowID).innerHTML = sHTML;
				}
			}
			else
			{
				document.getElementById('price_' + vRowID).innerHTML = FormatCurrency(cFinalUnitPrice, true);
			}
			
			// - End pijushb - 03/04/2011 - identiphoto - Set the Price based on Price Display Type 
			// and User Login session.

			
		}

		function loadOptions(oSelect){

			//oSelect is the drop list of child products
			var rowkey = oSelect.id.substring(5); //extract the id, remove the "keys_" prefix

			try {
				if ( oSelect.selectedIndex <= 0 ) {

					//clear the selection
					document.getElementById('qty_' + rowkey).innerHTML = '-';
					document.getElementById('price_' + rowkey).innerHTML = '-';

					if (bShowCartOpts) {
						aCartOpts = sCartOptions.split("|");

						for (var iCartOptCounter = 0, iCartOptGoTo = aCartOpts.length; iCartOptCounter <= iCartOptGoTo; iCartOptCounter++) {
							sCartOpt = aCartOpts[iCartOptCounter].split("~");

							jQuery('cart_opt_td_' + iCartOptCounter + '_' + rowkey).html() = '<em>' + sCartOpt[1] + '</em>';
						}
					}
				} else {
					var cinput;
					//load the selection
					// create qty input: named qty_<p_key>

					sInputPKey = jQuery('#keys_' + rowkey).val();

					jQuery('#' + rowkey + '_rand_val').attr('name', sInputPKey + '_rand_val');

					jQuery('#td_' + rowkey).html('<label class="atc"><input type="text" value="" size="2" name="qty_' + oSelect.value + '_' + rowkey + '" id="qty_' + rowkey + '" onchange="PriceFromBreaks(\'' + rowkey + '\');" onkeypress="return NumbersOnly(this, event);" /></label>');
				
					/*
					 * show price (use a bool option here?)
					 */
					var cPrice = childItems[oSelect.selectedIndex].price

					
	//				childItems[oSelect.selectedIndex].qtybreaks
					/*
					 * Begin pijushb - 03/04/2011 - identiphoto - Set the Price based on Price Display Type 
					 * and User Login session.
					 */
					var bShowATCPrice = false;
					var bShowRegPrice = false;
					var bShowATCQty	  = true;
					
					if ( bShowPriceDisplayType ) {
						
						switch ( sPriceDisplayType ) {
							case 'hide':
								jQuery('#price_' + rowkey).html("-");
								break;
							case 'show_message':
								jQuery('#price_' + rowkey).html(sPriceMessage);
								break;

							case 'require_atc':
								bShowATCPrice = true;
								break;

							case 'require_login_or_atc':
								
									bShowATCPrice = true;
								
								 break;

							/*
							 * pijushb 03/11/2011 - Add new case condition for IDENTIPHOTO
							 */
							case 'require_login_for_price_and_atc':
								
									bShowATCPrice = false;
									bShowATCQty = false;
								
								break;

							default: 
								 bShowRegPrice = true;
								break;
			
						} //- switch ( sPriceDisplayType )

					} //- if ( bShowPriceDisplayType )
					
					if ( bShowPriceDisplayType ) {
						if ( bShowRegPrice ) {
							jQuery('#price_' + rowkey).html(FormatCurrency(cPrice, true));
						} else if ( bShowATCQty ) {
						
							sTitle = "tip1"
						
							sHTML = '<a href="javascript:void(0);" onmouseover="Tip(\''+sTitle+'\',\''+sHelpText+'\',WIDTH, 400, DELAY,0, OFFSETX, -200, FADEIN, 200, FADEOUT, 200, FOLLOWMOUSE, false, ABOVE, true,OPACITY, 100, BALLOON, true);"><img align="absmiddle" src="common_images/b_helpicon.gif" border="0"/></a>';
							jQuery('#price_' + rowkey).html(sHTML);
						} else {
							sTitle = "tip1"
						
							sHTML = '<a href="javascript:void(0);" onmouseover="Tip(\''+sTitle+'\',\''+ sHelpTextLogin+'\',WIDTH, 400, DELAY,0, OFFSETX, -200, FADEIN, 200, FADEOUT, 200, FOLLOWMOUSE, false, ABOVE, true,OPACITY, 100, BALLOON, true);"><img align="absmiddle" src="common_images/b_helpicon.gif" border="0"/></a>';
							jQuery('#price_' + rowkey).html(sHTML);
						}
					} else {
						jQuery('#price_' + rowkey).html(FormatCurrency(cPrice, true));
					}

					if ( bShowCartOpts ) {
						aCartOpts = sCartOptions.split('|');
						
						if ( aCartOpts.length > 0 ) {

							for ( var iCartOptCounter = 0, iCartOptGoTo = aCartOpts.length - 1; iCartOptCounter <= iCartOptGoTo; iCartOptCounter++ ) {
								
								/*
								 * current cart option loading - split to pull out the 
								 * settings to determine to configure the current cart
								 * option
								 */
								sCartOpt		= aCartOpts[iCartOptCounter].split("~");

								/*
								 * build the value of the id for the cart option html input
								 */
								sCartOptID		= 'cart_opt_' + iCartOptCounter + '_' + rowkey;

								/*
								 * build the value for the current cart option javascript 
								 * function to be added to the html input
								 */
								sCartOptJSFunc	= 'buildCartOpt(\'' + rowkey + '\');';
								
								/*
								 * determine whether on parent product cart options are required
								 */
								var sRqdHiddenField = '';
								if ( bCartOptionsRqd ) {
									sRqdHiddenField = '<input type="hidden" id="rqd_' + sCartOptID + '" name="' + sCartOptID + '" value="1" />';
								} //- if ( bCartOptionsRqd )
								
								/*
								 * determine which html element to build for the current cart option
								 */
								switch ( sCartOpt[2] ) {
									case 'select':
										sCartOptInput = '<label class="atc"><select id="' + sCartOptID + '" name="' + sCartOptID + '" onchange="' + sCartOptJSFunc + '">' + getCartOptOptions(sCartOpt[3]) + '</select></label>' + sRqdHiddenField;
										break;

									case 'text-area':
										sCartOptInput = '<label class="atc"><textarea id="' + sCartOptID + '" name="' + sCartOptID + '"  onblur="' + sCartOptJSFunc + '"></textarea></label>' + sRqdHiddenField;
										break;

									default:
										sCartOptInput = '<label class="atc"><input type="text" id="' + sCartOptID + '" name="' + sCartOptID + '" size="15" maxlength="100" onblur="' + sCartOptJSFunc + '" /></label>' + sRqdHiddenField;
										break;						
								} //- switch ( sCartOpt[2] )
								
								/*
								 * add the current cart option to the table
								 */
								jQuery('#cart_opt_td_' + iCartOptCounter + '_' + rowkey).html(sCartOptInput);
							} //- for ( var iCartOptCounter = 0, iCartOptGoTo = aCartOpts.length - 1; iCartOptCounter <= iCartOptGoTo; iCartOptCounter++ )
							
							iCartOptCounter = iCartOptCounter - 1;

							jQuery('#cart_opt_td_' + iCartOptCounter + '_' + rowkey).append('<input type="hidden" id="cart_option_' + rowkey + '" name="cart_option_' + oSelect.value + '_' + rowkey + '" value="" />');

						} //- if ( aCartOpts.length > 0 )

					} //- if ( bShowCartOpts )

				} //- if ( oSelect.selectedIndex <= 0 )

			} catch (err) {
				alert('Loading selection: ' + err.mesage);
			}
		}

		/**
		 * Builds the hidden input for the data that gets posted 
		 * on the cart for the "cart_option"
		 *
		 * @author cainb
		 * @author dand
		 */
		function buildCartOpt(rowkey){
			try	{
				var cinput = '';
				var oSelect = document.getElementById('keys_' + rowkey);
				var p_id = oSelect.value;
				var p_index = oSelect.selectedIndex;
				var sCartOptions = '';
				var sChildProduct = window.oChildProds[window.sChildPkey];
				var bUseChildProdOpts = false;
				var sCartOptDelim = '~';

				if ( bUseChildProdOpts ) {
					aCartOpts = sChildProduct.cartOptions.split('|');
				} else {
					aCartOpts = sCartOptions.split('|');
				}

				for ( var iCOpt = 0, goTo = aCartOpts.length - 1; iCOpt <= goTo; iCOpt++ ) {
					aCartOpt = aCartOpts[iCOpt].split("~");

					cart_opt_type = aCartOpt[2];

					if ( jQuery('#cart_opt_' + iCOpt + '_' + rowkey).val() != '' ) {
						if ( cinput != '' ) {
							cinput += '|';
						}

						cart_opt_value = jQuery('#cart_opt_' + iCOpt + '_' + rowkey).val();

						if ( cart_opt_type == 'text-area' ) {
							cart_opt_value = cart_opt_value.replace('\n', '<br />');
						}

						cinput += aCartOpt[1] + sCartOptDelim + cart_opt_value;

					} //- if (document.getElementById('cart_opt_' + iCOpt + '_' + rowkey).value != '')

				} //- for ( var iCOpt = 0, goTo = aCartOpts.length - 1; iCOpt <= goTo; iCOpt++ )

				if (jQuery('#cart_option_' + rowkey).length > 0) {
					jQuery('#cart_option_' + rowkey).val(cinput);
				}
				
			} catch (err) {
				alert('Unable to build cart options. ' + err.mesage);
				//console.log('Unable to build cart options. ' + err.mesage);
			}
		}
		
		function hideProductContainer(){

			if (document.getElementById('sku_container'))
				document.getElementById('sku_container').innerHTML = '';
			
			if(document.getElementById('price_container'))
				document.getElementById('price_container').innerHTML = '';
			
			if (document.getElementById('idp_container'))
				document.getElementById('idp_container').innerHTML = '';

			if (document.getElementById('atc_container'))
				document.getElementById('atc_container').style.display = 'none';

			hideChildProductInputs();
		}

		function hideChildProductInputs(){

			if(document.getElementById('child_cart_section'))
				document.getElementById('child_cart_section').style.display = 'none';

			for (var iCO=0; iCO<=5; iCO++)
			{
				if(document.getElementById('pc_cart_options_'+iCO))
					jQuery('#pc_cart_options_'+iCO).slideUp();
			}
		
		}
		
		jQuery(function(){ // dom ready	
			
			/**
			 * load the default # of rows for the add-row view
			 * cart options
			 */
			if (sParentType == 1 && sChildDisplay == 'add-row') {

				/*
				 * initially add 2 rows
				 */
				addChildRows(2);
			}
			
			/*
			 * determine which view to load
			 */

			switch (sChildDisplay) {
				case 'matrix-one':
					fncColorSizes(false);
					break;
				case 'droplist-one':
					
					break;
				case 'droplist-two':
					fncGetOptDroplist(2, false, 2);
					break;
				case 'droplist-three': 
					fncGetOptDroplist(2, true, 3);
					break;
				case 'droplist-four':
					fncGetOptDroplist(2, true, 4);
					break;
				case 'droplist-five':
					fncGetOptDroplist(2, true, 5);
					break;
				case 'droplist-six':
					fncGetOptDroplist(2, true, 6);
					break;
				default:
					break;
			}
			
			/* set equal column heights for review items */
			jQuery('ul#reviews_bot li.clearfix').equalHeights();
			
			if(document.getElementById('pc_cart_options_0'))
				jQuery('#pc_cart_options_0').slideDown();

			/* ==============================================
			 * Event Handlers
			 * ============================================== */
		
			/*
			 * Register Addon Product select list
			 */
			jQuery('#addon_products').change(function(){
				fncUpdateAddonsSelectQty(this);
			});

			/*
			 * Update addon product (needed due to page caching)
			 */
			if ( bUseAddonProducts ) {

				if ( jQuery('#addon_products').length > 0 ) {
					fncUpdateAddonsSelectQty(jQuery('#addon_products')[0]);
				} //- if ( jQuery('#addon_products').length > 0 )

			} //- if ( bUseAddonProducts )

			/*
			 * Register Addon Product Checkboxes
			 */
			jQuery('#addon_product_container input:checkbox').click(function(){
				jQuery('#addon_qty_container').html('');
			
				jQuery('#addon_product_container input:checked').each(function(){
					jQuery('#addon_qty_container').append('<input type="hidden" value="1" name="qty_' + jQuery(this).val() + '"/>')
				});
			});

			/*
			 * Register Addon Product Form Validation
			 */
			if ( bUseAddonProducts ) {

				jQuery("form[action*='i_i_add_to_cart.asp']").submit(function(){
				
					//If error box is not present, a selection is not required
					if ( jQuery('#addon_prod_error').length == 0 ) {
						return true;
					}

					if ( jQuery('#addon_product_container input:checked').length > 0 ) {
						return true;
					} else if ( jQuery('#addon_product_container select option:selected').length > 0 ) {
						return true;
					} else {
						jQuery('#addon_prod_error').show();
						return false;
					} //- if ( jQuery('#addon_product_container input:checked').length > 0 )

				});

			} //- if ( bUseAddonProducts )
			
			/*
			 * Register AJAX Add To Cart Window Close Button
			 */
			jQuery('#atc_msg_close_win').click(function(event){
				event.preventDefault();
				closeCartLightbox();
			});
		
		});


		/**
		 * Function to Show/hide Buttons and message
		 * @author	pijushb
		 * @since	1/25/2012
		 */
		function funcShowHideButtons() {

			sPrevSku 		= jQuery('#previous_sku').val();
			bReviewMessage 	= jQuery('#review_message_' + sPrevSku).is(':visible');

			jQuery('#previous_sku').val(sPKey);

			if (bReviewMessage)
			{
				jQuery('#review_message_'+sPrevSku).hide();
			}

			bSubmitButton = jQuery('#submit_button').is(':visible')

			if ( ! bSubmitButton ) {
				jQuery('#submit_button').hide();
				jQuery('#check_stock_button').show();
				jQuery('#checkout_button').show();
			} else {
				jQuery('#submit_button').hide();
				jQuery('#check_stock_button').show();
				jQuery('#checkout_button').show();
			} //- if ( ! bSubmitButton )

		} //- function funcShowHideButtons()

		/**
		 * Function to add products to cart.
		 * @author	pijushb
		 * @since	1/25/2012
		 */
		function fncCheckout() {
			gotoCart();
		} //- function fncCheckout()

		/****************************************************************\
			Child Case-Quantity Validation
		\****************************************************************/
		if (bUseCaseQty)
		{
			switch (sChildDisplay)
			{
				case 'droplist-one':
				case 'droplist-two':
				case 'droplist-three':
				case 'droplist-four':
					// Add change event handler to update case size message
					jQuery('#prod_opt1').change(function() {
						var optionCaseSize = Number(this.options[this.selectedIndex].getAttribute("data-casesize"));
						var caseQtyMessage = jQuery('#caseqty-message');
						var bUseChildCaseQty = false

						if (bUseChildCaseQty) {
							if (optionCaseSize > 0)
							{
								caseQtyMessage.text(sCaseQtyText.replace('<qty>', optionCaseSize));
							} else {
								caseQtyMessage.text('');
							}
						}
					});

					// Fire change event
					jQuery('#prod_opt1').change();


					// Add handler to validate quantity against case size on submit
					jQuery('#frmAddToCart').submit(function(e) {
						var bUseChildCaseQty = false
						var sCaseQtyValidationText = '';
						var caseSize;

						if (bUseChildCaseQty)
						{
							caseSize = Number(jQuery('#prod_opt1 :selected').attr('data-casesize'));
						} else {
							caseSize = Number(0)
						}

						if (jQuery('#qty_box').val() % caseSize !== 0 && caseSize > 0)
						{
							alert(sCaseQtyValidationText.replace('<qty>', caseSize));
							return false;
						}

						return true;
					});

					break;
			}
		}

	</script>
					<div class="clearit"></div>
				</div><!-- End Content Padding -->
			</div><!-- End Content -->
		<div id="footer_top">
			<div id="newsletter">
				<h2>NEWSLETTER</h2>
				<p>Stay up to date on the latest news from Winning Moves Games by signing up for our Newsletter!</p>
				<a href="newsletter/">Sign Up Now!</a>
			</div>
			<div id="footer_links">
				
<ul id="foot_nav" class="qmmc">
	<li><span class="qmtitle">Consumer Support</span>

		<ul>
		<li><a href="https://winning-moves.com/form.asp?f_key=849B2319989D49ABA530EA3BE737C691">Contact Us</a></li>
		<li><a href="https://winning-moves.com/games/ReplacementParts.asp">Replacement Parts</a></li>
		<li><a href="rules">Rules &amp; Score Sheets</a></li>
		</ul></li>

	<li><span class="qmtitle"></span>

		<ul>
		<li><a href="https://winning-moves.com/privacy">Privacy</a></li>
		<li><a href="shipping">Shipping</a></li>
		</ul></li>

	<li><span class="qmdivider"></span></li>
	<li><span class="qmtitle">Retailer Support</span>

		<ul>
		<li><a href="http://winning-moves.com/2026_catalog">2026 Catalog</a></li>
		<li><a href="https://winning-moves.com/product_safety">Product Safety</a></li>
		</ul></li>

	<li><span class="qmdivider"></span></li>
	<li><span class="qmtitle">Company Info</span>

		<ul>
		<li><a href="https://winning-moves.com/about-us">About Us</a></li>
		<li><a href="https://winning-moves.com/environmental">Environmental</a></li>
		</ul></li>

	<li><span class="qmtitle"></span>

		<ul>
		<li><a href="https://winning-moves.com/inventors">Inventors</a></li>
		<li><a href="https://winning-moves.com/store_locator.asp">Store Locator</a></li>
		</ul></li>

	<li class="qmclear">&nbsp;</li>
</ul>
			</div>
		</div><!-- End Footer Top -->
		<div id="footer_bot">
			<div id="copyright"><script type="text/javascript">drawCopyright();</script>Â©2026 Winning Moves Games, Inc. |  35 Village Road, Suite 201, Middleton, MA 01949 | (800) 664-7788</div>
			<div id="pbwsp"><a href="http://www.websitepipeline.com/" rel="external" target="_blank">Ecommerce &amp; ERP Integration</a> by Website Pipeline</div>
		</div><!-- End Footer Bottom -->
		<div class="clearit"></div>
	</div><!-- End Container -->



<script type="text/javascript">
jQuery(document).ready(function() {
	jQuery('span.mgrfront-required').text('*');
});

jQuery('#add_this_productdetail').on('click', "a.addthis_button_facebook" , function(e) {e.preventDefault();});

jQuery('#readyToCheckOutSection').html('<h3>Shopping Cart Under Maintenance</h3>');

</script>

<script type="text/javascript">

var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-4265831-1']);
_gaq.push(['_trackPageview']);

(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

</script>


</body></html>